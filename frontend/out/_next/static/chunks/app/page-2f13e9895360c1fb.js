(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[931],{5920:function(e,s,t){Promise.resolve().then(t.bind(t,8734))},8734:function(e,s,t){"use strict";t.d(s,{default:function(){return U}});var a=t(7437),l=t(2265);let r="https://83d0wk5nj8.execute-api.us-east-2.amazonaws.com/production/api",i=[{id:1,name:"PROD-WEB-01",ipAddress:"192.168.1.10",macAddress:"00:1B:44:11:3A:B7",operatingSystem:"Windows Server 2019",type:"Server",client:"Acme Corp",site:"Main Office",status:"online",lastSeenAt:new Date().toISOString(),patchStatus:"compliant",pendingPatches:0,riskScore:25.5,vulnerabilityStats:{total:2,critical:0,high:0,medium:2,low:0},topVulnerabilities:[{cveId:"CVE-2024-7621",severity:"MEDIUM",cvssScore:5.3,description:"Moderate security vulnerability in web server component"}]},{id:2,name:"PROD-DB-01",ipAddress:"192.168.1.20",macAddress:"00:1B:44:11:3A:B8",operatingSystem:"Windows Server 2022",type:"Server",client:"Acme Corp",site:"Main Office",status:"online",lastSeenAt:new Date().toISOString(),patchStatus:"pending",pendingPatches:3,riskScore:78.2,vulnerabilityStats:{total:8,critical:2,high:3,medium:2,low:1},topVulnerabilities:[{cveId:"CVE-2024-9123",severity:"CRITICAL",cvssScore:9.8,description:"Critical RCE vulnerability allows remote code execution"},{cveId:"CVE-2024-8956",severity:"CRITICAL",cvssScore:9.1,description:"SQL injection vulnerability in database component"},{cveId:"CVE-2024-8745",severity:"HIGH",cvssScore:8.8,description:"Privilege escalation vulnerability"}]},{id:3,name:"PROD-APP-01",ipAddress:"192.168.1.30",macAddress:"00:1B:44:11:3A:B9",operatingSystem:"Ubuntu 22.04 LTS",type:"Server",client:"Acme Corp",site:"Main Office",status:"online",lastSeenAt:new Date().toISOString(),patchStatus:"compliant",pendingPatches:0,riskScore:32.1,vulnerabilityStats:{total:3,critical:0,high:1,medium:2,low:0},topVulnerabilities:[{cveId:"CVE-2024-7890",severity:"HIGH",cvssScore:7.5,description:"HTTP request smuggling vulnerability"},{cveId:"CVE-2024-7621",severity:"MEDIUM",cvssScore:5.3,description:"Moderate security vulnerability"}]},{id:4,name:"WORKSTATION-01",ipAddress:"192.168.2.10",macAddress:"00:1B:44:11:3A:BA",operatingSystem:"Windows 11 Pro",type:"Workstation",client:"Acme Corp",site:"Main Office",status:"online",lastSeenAt:new Date().toISOString(),patchStatus:"pending",pendingPatches:5,riskScore:65.8,vulnerabilityStats:{total:7,critical:1,high:3,medium:3,low:0},topVulnerabilities:[{cveId:"CVE-2024-9123",severity:"CRITICAL",cvssScore:9.8,description:"Critical RCE vulnerability allows remote code execution"},{cveId:"CVE-2024-8632",severity:"HIGH",cvssScore:8.1,description:"Authentication bypass vulnerability"}]},{id:5,name:"WORKSTATION-02",ipAddress:"192.168.2.11",macAddress:"00:1B:44:11:3A:BB",operatingSystem:"Windows 11 Pro",type:"Workstation",client:"Acme Corp",site:"Branch Office",status:"offline",lastSeenAt:new Date(Date.now()-72e5).toISOString(),patchStatus:"non-compliant",pendingPatches:12,riskScore:92.5,vulnerabilityStats:{total:15,critical:4,high:6,medium:5,low:0},topVulnerabilities:[{cveId:"CVE-2024-9123",severity:"CRITICAL",cvssScore:9.8,description:"Critical RCE vulnerability allows remote code execution"},{cveId:"CVE-2024-8956",severity:"CRITICAL",cvssScore:9.1,description:"SQL injection vulnerability"},{cveId:"CVE-2024-8745",severity:"HIGH",cvssScore:8.8,description:"Privilege escalation vulnerability"},{cveId:"CVE-2024-8632",severity:"HIGH",cvssScore:8.1,description:"Authentication bypass vulnerability"}]}],d=[{id:1,title:"High CPU Usage on SQL Server",description:"SQL Server on PROD-DB-01 showing 95% CPU utilization",severity:"critical",timestamp:new Date(Date.now()-9e5).toISOString(),deviceId:2,deviceName:"PROD-DB-01",status:"active"},{id:2,title:"Failed Windows Update",description:"KB5034441 failed to install on multiple workstations",severity:"high",timestamp:new Date(Date.now()-72e5).toISOString(),deviceId:4,deviceName:"WORKSTATION-01",status:"active"},{id:3,title:"Low Disk Space Warning",description:"C: drive on FILE-SRV-02 has less than 10% free space",severity:"medium",timestamp:new Date(Date.now()-144e5).toISOString(),deviceId:null,deviceName:"FILE-SRV-02",status:"active"}],n=[{id:"KB5034441",title:"Windows 11 Security Update",description:"Cumulative security update for Windows 11",severity:"CRITICAL",releaseDate:"2024-01-09",cveId:"CVE-2024-9123",cveIds:["CVE-2024-9123","CVE-2024-8956"],relatedCVEs:[{id:"CVE-2024-9123",severity:"CRITICAL",score:9.8},{id:"CVE-2024-8956",severity:"HIGH",score:7.5}],affectedDevices:[1,2],installedDevices:0,failedDevices:0,status:"AVAILABLE",vendor:"Microsoft",category:"Security Update",size:"450 MB",requiresReboot:!0},{id:"KB5034439",title:"Windows Server 2022 Update",description:"Monthly rollup for Windows Server 2022",severity:"HIGH",releaseDate:"2024-01-09",cveId:"CVE-2024-8745",cveIds:["CVE-2024-8745"],relatedCVEs:[{id:"CVE-2024-8745",severity:"HIGH",score:7.8}],affectedDevices:[3,4],installedDevices:1,failedDevices:0,status:"DEPLOYING",vendor:"Microsoft",category:"Monthly Rollup",size:"320 MB",requiresReboot:!0},{id:"UBUNTU-2024-01",title:"Ubuntu Security Updates",description:"Security updates for Ubuntu 22.04 LTS",severity:"MEDIUM",releaseDate:"2024-01-08",cveId:"CVE-2024-7621",cveIds:["CVE-2024-7621"],relatedCVEs:[{id:"CVE-2024-7621",severity:"MEDIUM",score:5.5}],affectedDevices:[5],installedDevices:1,failedDevices:0,status:"DEPLOYED",vendor:"Canonical",category:"Security Update",size:"125 MB",requiresReboot:!1}];async function c(e){let s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:2,a={...s,headers:{"Content-Type":"application/json",...s.headers}};for(let s=0;s<=t;s++)try{let s=await fetch(e,a);if(!s.ok)throw Error("HTTP error! status: ".concat(s.status));let t=await s.json();return{success:!0,data:t,fromCache:!1}}catch(a){if(console.warn("Attempt ".concat(s+1," failed for ").concat(e,":"),a.message),s===t)return{success:!1,data:null,error:a.message};await new Promise(e=>setTimeout(e,1e3*(s+1)))}}var o={async getInventory(){let e=await c("".concat(r,"/api/inventory"));return e.success?e:(console.log("Using mock inventory data"),{success:!0,data:i,fromCache:!0})},async scanDevice(e){let s=await c("".concat(r,"/api/scan-device/").concat(e),{method:"POST"});return s.success?s:{success:!0,data:{message:"Scan initiated (mock)"},fromCache:!0}},async getAlerts(){let e=await c("".concat(r,"/api/alerts"));return e.success?e:(console.log("Using mock alerts data"),{success:!0,data:d,fromCache:!0})},async acknowledgeAlert(e){let s=await c("".concat(r,"/api/alerts/").concat(e,"/acknowledge"),{method:"POST"});return s.success?s:{success:!0,data:{message:"Alert acknowledged (mock)"},fromCache:!0}},async resolveAlert(e,s){let t=await c("".concat(r,"/api/alerts/").concat(e,"/resolve"),{method:"POST",body:JSON.stringify({resolution:s})});return t.success?t:{success:!0,data:{message:"Alert resolved (mock)"},fromCache:!0}},async createAlert(e){let s=await c("".concat(r,"/api/alerts"),{method:"POST",body:JSON.stringify(e)});return s.success?s:{success:!0,data:{id:Date.now(),...e},fromCache:!0}},async getPatches(){let e=await c("".concat(r,"/api/patches"));return e.success?e:(console.log("Using mock patches data"),{success:!0,data:n,fromCache:!0})},async getPatchDetails(e){let s=await c("".concat(r,"/api/patches/").concat(e,"/details"));return s.success?s:{success:!0,data:n.find(s=>s.id===e)||{},fromCache:!0}},async analyzePatch(e){let s=await c("".concat(r,"/api/ai/analyze-patch"),{method:"POST",body:JSON.stringify(e)});if(!s.success){var t;let s=(null===(t=e.patch)||void 0===t?void 0:t.severity)||"MEDIUM",a="CRITICAL"===s||"HIGH"===s;return{success:!0,data:{recommendation:a?"REVIEW":"APPROVE",reasoning:a?"This patch addresses critical security vulnerabilities. Recommend thorough testing before production deployment.":"Patch has been analyzed and approved for deployment. Low risk of system disruption.",riskLevel:a?7:3,businessImpact:a?"HIGH":"LOW",confidence:.92,deploymentSteps:["Backup affected systems before deployment","Deploy to test environment first",a?"Conduct thorough testing for 24-48 hours":"Monitor for 2-4 hours","Deploy to production during maintenance window","Verify successful installation and system stability","Document deployment and any issues encountered"]},fromCache:!0}}return s},async deployPatch(e){let s=await c("".concat(r,"/api/patches/deploy"),{method:"POST",body:JSON.stringify(e)});return s.success?s:{success:!0,data:{jobId:"mock-".concat(Date.now()),message:"Deployment initiated (mock)"},fromCache:!0}},async getPatchStatus(){let e=await c("".concat(r,"/api/patches/status"));return e.success?e:{success:!0,data:{totalDevices:i.length,compliant:i.filter(e=>"compliant"===e.patchStatus).length,pending:i.filter(e=>"pending"===e.patchStatus).length,nonCompliant:i.filter(e=>"non-compliant"===e.patchStatus).length,lastUpdate:new Date().toISOString()},fromCache:!0}},async getPatchAnalysis(){let e=await c("".concat(r,"/api/patch-analysis"));return e.success?e:{success:!0,data:n,fromCache:!0}},async getPatchSchedule(){let e=await c("".concat(r,"/api/patch-schedule"));return e.success?e:{success:!0,data:[],fromCache:!0}},async getSchedules(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,s=e?"".concat(r,"/api/schedules?status=").concat(e):"".concat(r,"/api/schedules"),t=await c(s);return t.success?t:{success:!0,data:{schedules:[],count:0},fromCache:!0}},async createSchedule(e){let s=await c("".concat(r,"/api/schedules"),{method:"POST",body:JSON.stringify(e)});if(!s.success){var t;return{success:!0,data:{scheduleId:"mock-".concat(Date.now()),scheduledFor:e.scheduledFor,patchTitle:e.patchTitle,deviceCount:(null===(t=e.deviceIds)||void 0===t?void 0:t.length)||0,message:"Schedule created (mock)"},fromCache:!0}}return s},async getScheduleDetails(e){let s=await c("".concat(r,"/api/schedules/").concat(e));return s.success?s:{success:!1,error:"Schedule not found"}},async cancelSchedule(e){let s=await c("".concat(r,"/api/schedules/").concat(e),{method:"DELETE"});return s.success?s:{success:!0,data:{message:"Schedule cancelled (mock)"},fromCache:!0}}},x=()=>{var e,s,t,r;let[i,d]=(0,l.useState)([]),[n,c]=(0,l.useState)(!0),[x,m]=(0,l.useState)(null),[h,u]=(0,l.useState)(!1),[g,p]=(0,l.useState)("riskScore"),[b,v]=(0,l.useState)("all"),[y,j]=(0,l.useState)(""),[f,N]=(0,l.useState)(null),[w,S]=(0,l.useState)(!1),[D,C]=(0,l.useState)({});(0,l.useEffect)(()=>{I();let e=setInterval(I,3e4);return()=>clearInterval(e)},[]);let I=async()=>{try{m(null);let e=await o.getInventory();e.success?(d(e.data),u(e.fromCache||!1)):m(e.error||"Failed to fetch inventory")}catch(e){console.error("Error loading inventory:",e),m(e.message)}finally{c(!1)}},A=e=>{N(e),S(!0)},k=async e=>{C(s=>({...s,[e]:!0}));try{let s=await o.scanDevice(e);s.success?(alert("Scan initiated successfully for device ".concat(e,". ").concat(s.data.message||"")),setTimeout(()=>I(),2e3)):alert("Failed to initiate scan: "+s.error)}catch(e){console.error("Scan error:",e),alert("Failed to initiate scan: "+e.message)}finally{C(s=>({...s,[e]:!1}))}},E=e=>({CRITICAL:"text-red-600 bg-red-50",HIGH:"text-orange-600 bg-orange-50",MEDIUM:"text-yellow-600 bg-yellow-50",LOW:"text-blue-600 bg-blue-50"})[e]||"text-gray-600 bg-gray-50",L=e=>e>=80?"bg-red-100 text-red-800 border-red-200":e>=60?"bg-orange-100 text-orange-800 border-orange-200":e>=40?"bg-yellow-100 text-yellow-800 border-yellow-200":"bg-green-100 text-green-800 border-green-200",R=i.filter(e=>{var s,t,a,l,r;if("all"!==b&&!(null===(s=e.topVulnerabilities)||void 0===s?void 0:s.some(e=>e.severity===b)))return!1;if(y){let s=y.toLowerCase();return(null===(t=e.name)||void 0===t?void 0:t.toLowerCase().includes(s))||(null===(a=e.operatingSystem)||void 0===a?void 0:a.toLowerCase().includes(s))||(null===(l=e.ipAddress)||void 0===l?void 0:l.toLowerCase().includes(s))||(null===(r=e.client)||void 0===r?void 0:r.toLowerCase().includes(s))}return!0}).sort((e,s)=>{switch(g){case"riskScore":return(s.riskScore||0)-(e.riskScore||0);case"vulnerabilities":var t,a;return((null===(t=s.vulnerabilityStats)||void 0===t?void 0:t.total)||0)-((null===(a=e.vulnerabilityStats)||void 0===a?void 0:a.total)||0);case"name":return(e.name||"").localeCompare(s.name||"");default:return 0}});return n?(0,a.jsx)("div",{className:"flex items-center justify-center h-64",children:(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto"}),(0,a.jsx)("p",{className:"mt-4 text-gray-600",children:"Loading inventory..."})]})}):x?(0,a.jsxs)("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4",children:[(0,a.jsxs)("p",{className:"text-red-800",children:["Error: ",x]}),(0,a.jsx)("button",{onClick:I,className:"mt-2 px-4 py-2 bg-red-600 text-white rounded hover:bg-red-700",children:"Retry"})]}):(0,a.jsxs)("div",{className:"space-y-6",children:[h&&(0,a.jsx)("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-4",children:(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)("span",{className:"text-yellow-600",children:"⚠️"}),(0,a.jsx)("p",{className:"text-yellow-800 font-medium",children:"Using demo data - API unavailable. Showing sample devices for demonstration."})]})}),(0,a.jsxs)("div",{className:"bg-white rounded-lg shadow-sm p-6 border border-gray-200",children:[(0,a.jsx)("h2",{className:"text-2xl font-bold text-gray-900 mb-4",children:"Device Inventory"}),(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Search Devices"}),(0,a.jsx)("input",{type:"text",value:y,onChange:e=>j(e.target.value),placeholder:"Name, IP, OS, Client...",className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Sort By"}),(0,a.jsxs)("select",{value:g,onChange:e=>p(e.target.value),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[(0,a.jsx)("option",{value:"riskScore",children:"Risk Score (High to Low)"}),(0,a.jsx)("option",{value:"vulnerabilities",children:"Vulnerabilities (Most First)"}),(0,a.jsx)("option",{value:"name",children:"Device Name (A-Z)"})]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Filter by Severity"}),(0,a.jsxs)("select",{value:b,onChange:e=>v(e.target.value),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[(0,a.jsx)("option",{value:"all",children:"All Devices"}),(0,a.jsx)("option",{value:"CRITICAL",children:"Critical Only"}),(0,a.jsx)("option",{value:"HIGH",children:"High Only"}),(0,a.jsx)("option",{value:"MEDIUM",children:"Medium Only"})]})]})]}),(0,a.jsxs)("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 mt-6",children:[(0,a.jsxs)("div",{className:"bg-gray-50 rounded-lg p-3",children:[(0,a.jsx)("p",{className:"text-sm text-gray-600",children:"Total Devices"}),(0,a.jsx)("p",{className:"text-2xl font-bold text-gray-900",children:i.length})]}),(0,a.jsxs)("div",{className:"bg-red-50 rounded-lg p-3",children:[(0,a.jsx)("p",{className:"text-sm text-red-600",children:"High Risk"}),(0,a.jsx)("p",{className:"text-2xl font-bold text-red-600",children:i.filter(e=>e.riskScore>=80).length})]}),(0,a.jsxs)("div",{className:"bg-yellow-50 rounded-lg p-3",children:[(0,a.jsx)("p",{className:"text-sm text-yellow-600",children:"Medium Risk"}),(0,a.jsx)("p",{className:"text-2xl font-bold text-yellow-600",children:i.filter(e=>e.riskScore>=40&&e.riskScore<80).length})]}),(0,a.jsxs)("div",{className:"bg-green-50 rounded-lg p-3",children:[(0,a.jsx)("p",{className:"text-sm text-green-600",children:"Low Risk"}),(0,a.jsx)("p",{className:"text-2xl font-bold text-green-600",children:i.filter(e=>e.riskScore<40).length})]})]})]}),(0,a.jsx)("div",{className:"space-y-4",children:0===R.length?(0,a.jsx)("div",{className:"bg-white rounded-lg shadow-sm p-8 text-center border border-gray-200",children:(0,a.jsx)("p",{className:"text-gray-600",children:"No devices found matching your criteria."})}):R.map(e=>{var s,t,l,r;return(0,a.jsxs)("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 hover:shadow-md transition-shadow",children:[(0,a.jsx)("div",{className:"p-6",children:(0,a.jsx)("div",{className:"flex items-start justify-between",children:(0,a.jsxs)("div",{className:"flex-1",children:[(0,a.jsxs)("div",{className:"flex items-center gap-3 mb-2",children:[(0,a.jsx)("h3",{className:"text-xl font-bold text-gray-900",children:e.name}),(0,a.jsxs)("span",{className:"px-3 py-1 rounded-full text-xs font-semibold border ".concat(L(e.riskScore)),children:["Risk: ",e.riskScore.toFixed(1)]})]}),(0,a.jsxs)("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 text-sm mb-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-gray-500",children:"Type"}),(0,a.jsx)("p",{className:"font-medium text-gray-900",children:e.type})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-gray-500",children:"IP Address"}),(0,a.jsx)("p",{className:"font-medium text-gray-900",children:e.ipAddress})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-gray-500",children:"Client"}),(0,a.jsx)("p",{className:"font-medium text-gray-900",children:e.client})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-gray-500",children:"Site"}),(0,a.jsx)("p",{className:"font-medium text-gray-900",children:e.site})]})]}),(0,a.jsxs)("div",{className:"bg-gray-50 rounded-lg p-3 mb-4",children:[(0,a.jsx)("p",{className:"text-sm text-gray-600 mb-1",children:"Operating System"}),(0,a.jsx)("p",{className:"font-medium text-gray-900",children:e.operatingSystem})]}),(0,a.jsxs)("div",{className:"grid grid-cols-4 gap-3 mb-4",children:[(0,a.jsxs)("div",{className:"bg-white border border-gray-200 rounded-lg p-3 text-center",children:[(0,a.jsx)("p",{className:"text-2xl font-bold text-gray-900",children:(null===(s=e.vulnerabilityStats)||void 0===s?void 0:s.total)||0}),(0,a.jsx)("p",{className:"text-xs text-gray-600",children:"Total"})]}),(0,a.jsxs)("div",{className:"bg-red-50 border border-red-200 rounded-lg p-3 text-center",children:[(0,a.jsx)("p",{className:"text-2xl font-bold text-red-600",children:(null===(t=e.vulnerabilityStats)||void 0===t?void 0:t.critical)||0}),(0,a.jsx)("p",{className:"text-xs text-red-600",children:"Critical"})]}),(0,a.jsxs)("div",{className:"bg-orange-50 border border-orange-200 rounded-lg p-3 text-center",children:[(0,a.jsx)("p",{className:"text-2xl font-bold text-orange-600",children:(null===(l=e.vulnerabilityStats)||void 0===l?void 0:l.high)||0}),(0,a.jsx)("p",{className:"text-xs text-orange-600",children:"High"})]}),(0,a.jsxs)("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-3 text-center",children:[(0,a.jsx)("p",{className:"text-2xl font-bold text-yellow-600",children:(null===(r=e.vulnerabilityStats)||void 0===r?void 0:r.medium)||0}),(0,a.jsx)("p",{className:"text-xs text-yellow-600",children:"Medium"})]})]}),e.topVulnerabilities&&e.topVulnerabilities.length>0&&(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-sm font-semibold text-gray-700 mb-2",children:"Top Vulnerabilities"}),(0,a.jsx)("div",{className:"space-y-2",children:e.topVulnerabilities.slice(0,3).map((e,s)=>(0,a.jsxs)("div",{className:"flex items-center justify-between bg-gray-50 rounded-lg p-2 border border-gray-200",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)("span",{className:"font-mono text-sm font-medium text-gray-900",children:e.cveId}),(0,a.jsx)("span",{className:"px-2 py-0.5 rounded text-xs font-semibold ".concat(E(e.severity)),children:e.severity})]}),(0,a.jsxs)("span",{className:"text-sm font-bold text-gray-900",children:["CVSS: ",e.cvssScore]})]},s))})]})]})})}),(0,a.jsxs)("div",{className:"bg-gray-50 px-6 py-3 border-t border-gray-200 flex items-center justify-between rounded-b-lg",children:[(0,a.jsxs)("p",{className:"text-sm text-gray-600",children:["Last Seen: ",new Date(e.lastSeenAt).toLocaleString()]}),(0,a.jsxs)("div",{className:"flex gap-2",children:[(0,a.jsx)("button",{onClick:()=>A(e),className:"px-4 py-2 bg-blue-600 text-white text-sm rounded-lg hover:bg-blue-700 transition-colors",children:"View Details"}),(0,a.jsx)("button",{onClick:()=>k(e.id),disabled:D[e.id],className:"px-4 py-2 text-sm rounded-lg transition-colors ".concat(D[e.id]?"bg-gray-400 text-white cursor-not-allowed":"bg-gray-200 text-gray-700 hover:bg-gray-300"),children:D[e.id]?"Scanning...":"Scan Now"})]})]})]},e.id)})}),w&&f&&(0,a.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:(0,a.jsxs)("div",{className:"bg-white rounded-lg shadow-2xl max-w-4xl w-full max-h-[90vh] overflow-y-auto",children:[(0,a.jsxs)("div",{className:"sticky top-0 bg-gradient-to-r from-blue-600 to-indigo-600 text-white px-6 py-4 flex justify-between items-center",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("h2",{className:"text-2xl font-bold",children:f.name}),(0,a.jsxs)("p",{className:"text-sm opacity-90",children:["Device ID: ",f.id]})]}),(0,a.jsx)("button",{onClick:()=>S(!1),className:"text-white hover:bg-white hover:bg-opacity-20 rounded-lg p-2 transition-colors",children:(0,a.jsx)("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,a.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),(0,a.jsxs)("div",{className:"p-6 space-y-6",children:[(0,a.jsx)("div",{className:"rounded-lg p-4 border-2 ".concat(L(f.riskScore)),children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-sm font-medium opacity-80",children:"Overall Risk Score"}),(0,a.jsxs)("p",{className:"text-3xl font-bold",children:[f.riskScore.toFixed(1),"/100"]})]}),(0,a.jsx)("div",{className:"text-5xl",children:f.riskScore>=80?"\uD83D\uDD34":f.riskScore>=60?"\uD83D\uDFE0":f.riskScore>=40?"\uD83D\uDFE1":"\uD83D\uDFE2"})]})}),(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,a.jsxs)("div",{className:"bg-gray-50 rounded-lg p-4",children:[(0,a.jsx)("p",{className:"text-sm text-gray-600 mb-1",children:"Type"}),(0,a.jsx)("p",{className:"font-semibold text-gray-900",children:f.type})]}),(0,a.jsxs)("div",{className:"bg-gray-50 rounded-lg p-4",children:[(0,a.jsx)("p",{className:"text-sm text-gray-600 mb-1",children:"IP Address"}),(0,a.jsx)("p",{className:"font-semibold text-gray-900",children:f.ipAddress})]}),(0,a.jsxs)("div",{className:"bg-gray-50 rounded-lg p-4",children:[(0,a.jsx)("p",{className:"text-sm text-gray-600 mb-1",children:"MAC Address"}),(0,a.jsx)("p",{className:"font-semibold text-gray-900",children:f.macAddress})]}),(0,a.jsxs)("div",{className:"bg-gray-50 rounded-lg p-4",children:[(0,a.jsx)("p",{className:"text-sm text-gray-600 mb-1",children:"Last Seen"}),(0,a.jsx)("p",{className:"font-semibold text-gray-900",children:new Date(f.lastSeenAt).toLocaleString()})]}),(0,a.jsxs)("div",{className:"bg-gray-50 rounded-lg p-4",children:[(0,a.jsx)("p",{className:"text-sm text-gray-600 mb-1",children:"Client"}),(0,a.jsx)("p",{className:"font-semibold text-gray-900",children:f.client})]}),(0,a.jsxs)("div",{className:"bg-gray-50 rounded-lg p-4",children:[(0,a.jsx)("p",{className:"text-sm text-gray-600 mb-1",children:"Site"}),(0,a.jsx)("p",{className:"font-semibold text-gray-900",children:f.site})]})]}),(0,a.jsxs)("div",{className:"bg-blue-50 rounded-lg p-4 border border-blue-200",children:[(0,a.jsx)("p",{className:"text-sm text-blue-600 font-medium mb-2",children:"Operating System"}),(0,a.jsx)("p",{className:"text-lg font-semibold text-gray-900",children:f.operatingSystem})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("h3",{className:"text-lg font-bold text-gray-900 mb-3",children:"Vulnerability Statistics"}),(0,a.jsxs)("div",{className:"grid grid-cols-4 gap-3",children:[(0,a.jsxs)("div",{className:"bg-white border-2 border-gray-200 rounded-lg p-4 text-center",children:[(0,a.jsx)("p",{className:"text-3xl font-bold text-gray-900",children:(null===(e=f.vulnerabilityStats)||void 0===e?void 0:e.total)||0}),(0,a.jsx)("p",{className:"text-sm text-gray-600 mt-1",children:"Total"})]}),(0,a.jsxs)("div",{className:"bg-red-50 border-2 border-red-200 rounded-lg p-4 text-center",children:[(0,a.jsx)("p",{className:"text-3xl font-bold text-red-600",children:(null===(s=f.vulnerabilityStats)||void 0===s?void 0:s.critical)||0}),(0,a.jsx)("p",{className:"text-sm text-red-600 mt-1",children:"Critical"})]}),(0,a.jsxs)("div",{className:"bg-orange-50 border-2 border-orange-200 rounded-lg p-4 text-center",children:[(0,a.jsx)("p",{className:"text-3xl font-bold text-orange-600",children:(null===(t=f.vulnerabilityStats)||void 0===t?void 0:t.high)||0}),(0,a.jsx)("p",{className:"text-sm text-orange-600 mt-1",children:"High"})]}),(0,a.jsxs)("div",{className:"bg-yellow-50 border-2 border-yellow-200 rounded-lg p-4 text-center",children:[(0,a.jsx)("p",{className:"text-3xl font-bold text-yellow-600",children:(null===(r=f.vulnerabilityStats)||void 0===r?void 0:r.medium)||0}),(0,a.jsx)("p",{className:"text-sm text-yellow-600 mt-1",children:"Medium"})]})]})]}),f.topVulnerabilities&&f.topVulnerabilities.length>0&&(0,a.jsxs)("div",{children:[(0,a.jsx)("h3",{className:"text-lg font-bold text-gray-900 mb-3",children:"All Vulnerabilities"}),(0,a.jsx)("div",{className:"space-y-2",children:f.topVulnerabilities.map((e,s)=>(0,a.jsxs)("div",{className:"bg-gray-50 rounded-lg p-4 border border-gray-200 hover:border-blue-300 hover:bg-blue-50 transition-colors",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,a.jsxs)("div",{className:"flex items-center gap-3",children:[(0,a.jsx)("span",{className:"font-mono text-lg font-bold text-gray-900",children:e.cveId}),(0,a.jsx)("span",{className:"px-3 py-1 rounded-full text-xs font-bold ".concat(E(e.severity)),children:e.severity})]}),(0,a.jsxs)("div",{className:"text-right",children:[(0,a.jsx)("p",{className:"text-sm text-gray-600",children:"CVSS Score"}),(0,a.jsx)("p",{className:"text-2xl font-bold text-gray-900",children:e.cvssScore})]})]}),e.description&&(0,a.jsx)("p",{className:"text-sm text-gray-700 mt-2",children:e.description})]},s))})]}),(0,a.jsxs)("div",{className:"flex gap-3 pt-4 border-t border-gray-200",children:[(0,a.jsx)("button",{onClick:()=>k(f.id),disabled:D[f.id],className:"flex-1 py-3 rounded-lg font-semibold transition-colors ".concat(D[f.id]?"bg-gray-400 text-white cursor-not-allowed":"bg-blue-600 text-white hover:bg-blue-700"),children:D[f.id]?"Scanning...":"\uD83D\uDD0D Rescan Device"}),(0,a.jsx)("button",{onClick:()=>S(!1),className:"flex-1 py-3 bg-gray-200 text-gray-700 rounded-lg font-semibold hover:bg-gray-300 transition-colors",children:"Close"})]})]})]})})]})},m=()=>{var e;let[s,t]=(0,l.useState)([]),[r,i]=(0,l.useState)(!0),[d,n]=(0,l.useState)(null),[c,x]=(0,l.useState)(!1),[m,h]=(0,l.useState)("all"),[u,g]=(0,l.useState)("all"),[p,b]=(0,l.useState)({}),[v,y]=(0,l.useState)(null),[j,f]=(0,l.useState)(!1),[N,w]=(0,l.useState)(!1),[S,D]=(0,l.useState)({title:"",description:"",severity:"MEDIUM",deviceId:"",deviceName:""});(0,l.useEffect)(()=>{C();let e=setInterval(C,3e4);return()=>clearInterval(e)},[]);let C=async()=>{try{let e=await o.getAlerts();e.success?(t(e.data),w(e.fromCache||!1),n(null)):n("Failed to load alerts"),i(!1)}catch(e){console.error("Error loading alerts:",e),n(e.message),i(!1)}},I=async e=>{b(s=>({...s,[e]:"acknowledging"}));try{if((await o.acknowledgeAlert(e)).success)t(s.map(s=>s.id===e?{...s,status:"ACKNOWLEDGED",updatedAt:new Date().toISOString()}:s)),alert("Alert ".concat(e," acknowledged successfully"));else throw Error("Failed to acknowledge alert")}catch(e){console.error("Acknowledge error:",e),alert("Failed to acknowledge alert: "+e.message)}finally{b(s=>({...s,[e]:null}))}},A=async e=>{b(s=>({...s,[e]:"resolving"}));try{if((await o.resolveAlert(e,"Manually resolved")).success)t(s.map(s=>s.id===e?{...s,status:"RESOLVED",updatedAt:new Date().toISOString()}:s)),alert("Alert ".concat(e," resolved successfully"));else throw Error("Failed to resolve alert")}catch(e){console.error("Resolve error:",e),alert("Failed to resolve alert: "+e.message)}finally{b(s=>({...s,[e]:null}))}},k=async(e,s)=>{try{let t=await o.getInventory();if(t.success){let a=t.data.find(s=>s.id===e);a?(y(a),f(!0)):alert("Device ".concat(s," not found in inventory"))}else throw Error("Failed to fetch device")}catch(e){console.error("View device error:",e),alert("Failed to load device details: "+e.message)}},E=async e=>{e.preventDefault();try{let e=await o.createAlert(S);if(e.success)t([e.data,...s]),x(!1),D({title:"",description:"",severity:"MEDIUM",deviceId:"",deviceName:""});else throw Error("Failed to create alert")}catch(e){console.error("Error creating alert:",e),alert("Failed to create alert: "+e.message)}},L=e=>({CRITICAL:"bg-red-100 text-red-800 border-red-200",HIGH:"bg-orange-100 text-orange-800 border-orange-200",MEDIUM:"bg-yellow-100 text-yellow-800 border-yellow-200",LOW:"bg-blue-100 text-blue-800 border-blue-200"})[e]||"bg-gray-100 text-gray-800 border-gray-200",R=e=>({ACTIVE:"bg-green-100 text-green-800 border-green-200",ACKNOWLEDGED:"bg-blue-100 text-blue-800 border-blue-200",RESOLVED:"bg-gray-100 text-gray-800 border-gray-200"})[e]||"bg-gray-100 text-gray-800 border-gray-200",V=s.filter(e=>("all"===m||e.status===m)&&("all"===u||e.severity===u));return r?(0,a.jsx)("div",{className:"flex items-center justify-center h-64",children:(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto"}),(0,a.jsx)("p",{className:"mt-4 text-gray-600",children:"Loading alerts..."})]})}):d?(0,a.jsxs)("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4",children:[(0,a.jsxs)("p",{className:"text-red-800",children:["Error: ",d]}),(0,a.jsx)("button",{onClick:C,className:"mt-2 px-4 py-2 bg-red-600 text-white rounded hover:bg-red-700",children:"Retry"})]}):(0,a.jsxs)("div",{className:"space-y-6",children:[N&&(0,a.jsx)("div",{className:"bg-yellow-50 border-l-4 border-yellow-400 p-4 rounded",children:(0,a.jsxs)("div",{className:"flex",children:[(0,a.jsx)("div",{className:"flex-shrink-0",children:(0,a.jsx)("svg",{className:"h-5 w-5 text-yellow-400",viewBox:"0 0 20 20",fill:"currentColor",children:(0,a.jsx)("path",{fillRule:"evenodd",d:"M8.257 3.099c.765-1.36 2.722-1.36 3.486 0l5.58 9.92c.75 1.334-.213 2.98-1.742 2.98H4.42c-1.53 0-2.493-1.646-1.743-2.98l5.58-9.92zM11 13a1 1 0 11-2 0 1 1 0 012 0zm-1-8a1 1 0 00-1 1v3a1 1 0 002 0V6a1 1 0 00-1-1z",clipRule:"evenodd"})})}),(0,a.jsx)("div",{className:"ml-3",children:(0,a.jsx)("p",{className:"text-sm text-yellow-700",children:"⚠️ Using demo data - API unavailable. Showing sample alerts for demonstration."})})]})}),(0,a.jsxs)("div",{className:"bg-white rounded-lg shadow-sm p-6 border border-gray-200",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,a.jsx)("h2",{className:"text-2xl font-bold text-gray-900",children:"Alert Management"}),(0,a.jsx)("button",{onClick:()=>x(!c),className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors font-semibold",children:c?"Cancel":"+ Create Alert"})]}),c&&(0,a.jsxs)("form",{onSubmit:E,className:"bg-gray-50 rounded-lg p-4 mb-4 border border-gray-200",children:[(0,a.jsx)("h3",{className:"font-semibold text-gray-900 mb-4",children:"Create New Alert"}),(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Alert Title *"}),(0,a.jsx)("input",{type:"text",required:!0,value:S.title,onChange:e=>D({...S,title:e.target.value}),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"Critical Security Issue"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Severity *"}),(0,a.jsxs)("select",{required:!0,value:S.severity,onChange:e=>D({...S,severity:e.target.value}),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[(0,a.jsx)("option",{value:"LOW",children:"Low"}),(0,a.jsx)("option",{value:"MEDIUM",children:"Medium"}),(0,a.jsx)("option",{value:"HIGH",children:"High"}),(0,a.jsx)("option",{value:"CRITICAL",children:"Critical"})]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Device ID"}),(0,a.jsx)("input",{type:"text",value:S.deviceId,onChange:e=>D({...S,deviceId:e.target.value}),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"dev-001"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Device Name"}),(0,a.jsx)("input",{type:"text",value:S.deviceName,onChange:e=>D({...S,deviceName:e.target.value}),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"WEB-SERVER-01"})]}),(0,a.jsxs)("div",{className:"md:col-span-2",children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Description *"}),(0,a.jsx)("textarea",{required:!0,rows:"3",value:S.description,onChange:e=>D({...S,description:e.target.value}),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"Detailed description of the alert..."})]})]}),(0,a.jsx)("div",{className:"mt-4 flex justify-end",children:(0,a.jsx)("button",{type:"submit",className:"px-6 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors font-semibold",children:"Create Alert"})})]}),(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Filter by Status"}),(0,a.jsxs)("select",{value:m,onChange:e=>h(e.target.value),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[(0,a.jsx)("option",{value:"all",children:"All Statuses"}),(0,a.jsx)("option",{value:"ACTIVE",children:"Active"}),(0,a.jsx)("option",{value:"ACKNOWLEDGED",children:"Acknowledged"}),(0,a.jsx)("option",{value:"RESOLVED",children:"Resolved"})]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Filter by Severity"}),(0,a.jsxs)("select",{value:u,onChange:e=>g(e.target.value),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[(0,a.jsx)("option",{value:"all",children:"All Severities"}),(0,a.jsx)("option",{value:"CRITICAL",children:"Critical"}),(0,a.jsx)("option",{value:"HIGH",children:"High"}),(0,a.jsx)("option",{value:"MEDIUM",children:"Medium"}),(0,a.jsx)("option",{value:"LOW",children:"Low"})]})]})]}),(0,a.jsxs)("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 mt-6",children:[(0,a.jsxs)("div",{className:"bg-gray-50 rounded-lg p-3",children:[(0,a.jsx)("p",{className:"text-sm text-gray-600",children:"Total Alerts"}),(0,a.jsx)("p",{className:"text-2xl font-bold text-gray-900",children:s.length})]}),(0,a.jsxs)("div",{className:"bg-red-50 rounded-lg p-3",children:[(0,a.jsx)("p",{className:"text-sm text-red-600",children:"Critical"}),(0,a.jsx)("p",{className:"text-2xl font-bold text-red-600",children:s.filter(e=>"CRITICAL"===e.severity).length})]}),(0,a.jsxs)("div",{className:"bg-orange-50 rounded-lg p-3",children:[(0,a.jsx)("p",{className:"text-sm text-orange-600",children:"High"}),(0,a.jsx)("p",{className:"text-2xl font-bold text-orange-600",children:s.filter(e=>"HIGH"===e.severity).length})]}),(0,a.jsxs)("div",{className:"bg-green-50 rounded-lg p-3",children:[(0,a.jsx)("p",{className:"text-sm text-green-600",children:"Active"}),(0,a.jsx)("p",{className:"text-2xl font-bold text-green-600",children:s.filter(e=>"ACTIVE"===e.status).length})]})]})]}),(0,a.jsx)("div",{className:"space-y-4",children:0===V.length?(0,a.jsx)("div",{className:"bg-white rounded-lg shadow-sm p-8 text-center border border-gray-200",children:(0,a.jsx)("p",{className:"text-gray-600",children:"No alerts found matching your criteria."})}):V.map(e=>(0,a.jsxs)("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 hover:shadow-md transition-shadow",children:[(0,a.jsxs)("div",{className:"p-6",children:[(0,a.jsx)("div",{className:"flex items-start justify-between mb-4",children:(0,a.jsxs)("div",{className:"flex-1",children:[(0,a.jsxs)("div",{className:"flex items-center gap-3 mb-2",children:[(0,a.jsx)("h3",{className:"text-lg font-bold text-gray-900",children:e.title}),(0,a.jsx)("span",{className:"px-3 py-1 rounded-full text-xs font-semibold border ".concat(L(e.severity)),children:e.severity}),(0,a.jsx)("span",{className:"px-3 py-1 rounded-full text-xs font-semibold border ".concat(R(e.status)),children:e.status})]}),(0,a.jsx)("p",{className:"text-gray-700 mb-4",children:e.description})]})}),(0,a.jsxs)("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 text-sm mb-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-gray-500",children:"Device"}),(0,a.jsx)("p",{className:"font-medium text-gray-900",children:e.deviceName||"N/A"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-gray-500",children:"Source"}),(0,a.jsx)("p",{className:"font-medium text-gray-900",children:e.source})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-gray-500",children:"Created"}),(0,a.jsx)("p",{className:"font-medium text-gray-900",children:new Date(e.createdAt).toLocaleString()})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-gray-500",children:"Updated"}),(0,a.jsx)("p",{className:"font-medium text-gray-900",children:new Date(e.updatedAt).toLocaleString()})]})]}),e.relatedVulnerabilities>0&&(0,a.jsxs)("div",{className:"bg-gray-50 rounded-lg p-4 mb-4 border border-gray-200",children:[(0,a.jsx)("p",{className:"text-sm font-semibold text-gray-700 mb-2",children:"Vulnerability Context"}),(0,a.jsxs)("div",{className:"grid grid-cols-3 gap-4 text-center",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-2xl font-bold text-gray-900",children:e.relatedVulnerabilities}),(0,a.jsx)("p",{className:"text-xs text-gray-600",children:"Related CVEs"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-2xl font-bold text-red-600",children:e.criticalVulnerabilities}),(0,a.jsx)("p",{className:"text-xs text-red-600",children:"Critical"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-2xl font-bold text-orange-600",children:e.highVulnerabilities}),(0,a.jsx)("p",{className:"text-xs text-orange-600",children:"High"})]})]}),e.vulnerabilityDetails&&e.vulnerabilityDetails.length>0&&(0,a.jsx)("div",{className:"mt-4 space-y-2",children:e.vulnerabilityDetails.map((e,s)=>(0,a.jsxs)("div",{className:"bg-white rounded p-2 border border-gray-200",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)("span",{className:"font-mono text-sm font-medium",children:e.cveId}),(0,a.jsx)("span",{className:"px-2 py-0.5 rounded text-xs font-semibold ".concat(L(e.severity)),children:e.severity})]}),(0,a.jsxs)("span",{className:"text-sm font-bold",children:["CVSS: ",e.cvssScore]})]}),(0,a.jsx)("p",{className:"text-sm text-gray-600 mt-1",children:e.description})]},s))})]})]}),(0,a.jsxs)("div",{className:"bg-gray-50 px-6 py-3 border-t border-gray-200 flex justify-between items-center rounded-b-lg",children:[(0,a.jsxs)("p",{className:"text-sm text-gray-600",children:["ID: ",e.id]}),(0,a.jsxs)("div",{className:"flex gap-2",children:[(0,a.jsx)("button",{onClick:()=>I(e.id),disabled:"ACKNOWLEDGED"===e.status||"RESOLVED"===e.status||"acknowledging"===p[e.id],className:"px-4 py-2 text-sm rounded-lg transition-colors ".concat("ACKNOWLEDGED"===e.status||"RESOLVED"===e.status?"bg-gray-300 text-gray-500 cursor-not-allowed":"acknowledging"===p[e.id]?"bg-blue-400 text-white cursor-wait":"bg-blue-600 text-white hover:bg-blue-700"),children:"acknowledging"===p[e.id]?"Acknowledging...":"ACKNOWLEDGED"===e.status?"Acknowledged":"Acknowledge"}),(0,a.jsx)("button",{onClick:()=>A(e.id),disabled:"RESOLVED"===e.status||"resolving"===p[e.id],className:"px-4 py-2 text-sm rounded-lg transition-colors ".concat("RESOLVED"===e.status?"bg-gray-300 text-gray-500 cursor-not-allowed":"resolving"===p[e.id]?"bg-green-400 text-white cursor-wait":"bg-green-600 text-white hover:bg-green-700"),children:"resolving"===p[e.id]?"Resolving...":"RESOLVED"===e.status?"Resolved":"Resolve"}),(0,a.jsx)("button",{onClick:()=>k(e.deviceId,e.deviceName),className:"px-4 py-2 bg-gray-200 text-gray-700 text-sm rounded-lg hover:bg-gray-300 transition-colors",children:"View Device"})]})]})]},e.id))}),j&&v&&(0,a.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:(0,a.jsxs)("div",{className:"bg-white rounded-lg shadow-2xl max-w-3xl w-full max-h-[90vh] overflow-y-auto",children:[(0,a.jsxs)("div",{className:"sticky top-0 bg-gradient-to-r from-blue-600 to-indigo-600 text-white px-6 py-4 flex justify-between items-center",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("h2",{className:"text-2xl font-bold",children:v.name}),(0,a.jsx)("p",{className:"text-sm opacity-90",children:"Device from Alert"})]}),(0,a.jsx)("button",{onClick:()=>f(!1),className:"text-white hover:bg-white hover:bg-opacity-20 rounded-lg p-2 transition-colors",children:(0,a.jsx)("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,a.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),(0,a.jsxs)("div",{className:"p-6 space-y-4",children:[(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,a.jsxs)("div",{className:"bg-gray-50 rounded-lg p-3",children:[(0,a.jsx)("p",{className:"text-sm text-gray-600",children:"Type"}),(0,a.jsx)("p",{className:"font-semibold text-gray-900",children:v.type})]}),(0,a.jsxs)("div",{className:"bg-gray-50 rounded-lg p-3",children:[(0,a.jsx)("p",{className:"text-sm text-gray-600",children:"IP Address"}),(0,a.jsx)("p",{className:"font-semibold text-gray-900",children:v.ipAddress})]}),(0,a.jsxs)("div",{className:"bg-gray-50 rounded-lg p-3",children:[(0,a.jsx)("p",{className:"text-sm text-gray-600",children:"Operating System"}),(0,a.jsx)("p",{className:"font-semibold text-gray-900",children:v.operatingSystem})]}),(0,a.jsxs)("div",{className:"bg-gray-50 rounded-lg p-3",children:[(0,a.jsx)("p",{className:"text-sm text-gray-600",children:"Risk Score"}),(0,a.jsxs)("p",{className:"font-semibold text-gray-900",children:[v.riskScore.toFixed(1),"/100"]})]})]}),(0,a.jsxs)("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4",children:[(0,a.jsx)("p",{className:"text-sm font-semibold text-red-800 mb-2",children:"Critical Vulnerabilities"}),(0,a.jsx)("p",{className:"text-3xl font-bold text-red-600",children:(null===(e=v.vulnerabilityStats)||void 0===e?void 0:e.critical)||0})]}),(0,a.jsx)("button",{onClick:()=>f(!1),className:"w-full py-3 bg-gray-200 text-gray-700 rounded-lg font-semibold hover:bg-gray-300 transition-colors",children:"Close"})]})]})})]})};let h=e=>e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),u=e=>e.replace(/^([A-Z])|[\s-_]+(\w)/g,(e,s,t)=>t?t.toUpperCase():s.toLowerCase()),g=e=>{let s=u(e);return s.charAt(0).toUpperCase()+s.slice(1)},p=function(){for(var e=arguments.length,s=Array(e),t=0;t<e;t++)s[t]=arguments[t];return s.filter((e,s,t)=>!!e&&""!==e.trim()&&t.indexOf(e)===s).join(" ").trim()},b=e=>{for(let s in e)if(s.startsWith("aria-")||"role"===s||"title"===s)return!0};var v={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};let y=(0,l.forwardRef)((e,s)=>{let{color:t="currentColor",size:a=24,strokeWidth:r=2,absoluteStrokeWidth:i,className:d="",children:n,iconNode:c,...o}=e;return(0,l.createElement)("svg",{ref:s,...v,width:a,height:a,stroke:t,strokeWidth:i?24*Number(r)/Number(a):r,className:p("lucide",d),...!n&&!b(o)&&{"aria-hidden":"true"},...o},[...c.map(e=>{let[s,t]=e;return(0,l.createElement)(s,t)}),...Array.isArray(n)?n:[n]])}),j=(e,s)=>{let t=(0,l.forwardRef)((t,a)=>{let{className:r,...i}=t;return(0,l.createElement)(y,{ref:a,iconNode:s,className:p("lucide-".concat(h(g(e))),"lucide-".concat(e),r),...i})});return t.displayName=g(e),t},f=j("search",[["path",{d:"m21 21-4.34-4.34",key:"14j7rj"}],["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}]]),N=j("refresh-cw",[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]]),w=j("shield",[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}]]),S=j("calendar",[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]]),D=j("server",[["rect",{width:"20",height:"8",x:"2",y:"2",rx:"2",ry:"2",key:"ngkwjq"}],["rect",{width:"20",height:"8",x:"2",y:"14",rx:"2",ry:"2",key:"iecqi9"}],["line",{x1:"6",x2:"6.01",y1:"6",y2:"6",key:"16zg32"}],["line",{x1:"6",x2:"6.01",y1:"18",y2:"18",key:"nzw8ys"}]]),C=j("download",[["path",{d:"M12 15V3",key:"m9g1x1"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["path",{d:"m7 10 5 5 5-5",key:"brsn70"}]]),I=j("activity",[["path",{d:"M22 12h-2.48a2 2 0 0 0-1.93 1.46l-2.35 8.36a.25.25 0 0 1-.48 0L9.24 2.18a.25.25 0 0 0-.48 0l-2.35 8.36A2 2 0 0 1 4.49 12H2",key:"169zse"}]]),A=j("triangle-alert",[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3",key:"wmoenq"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]]),k=j("clock",[["path",{d:"M12 6v6l4 2",key:"mmk7yg"}],["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]]),E=j("eye",[["path",{d:"M2.062 12.348a1 1 0 0 1 0-.696 10.75 10.75 0 0 1 19.876 0 1 1 0 0 1 0 .696 10.75 10.75 0 0 1-19.876 0",key:"1nclc0"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]),L=j("trending-up",[["path",{d:"M16 7h6v6",key:"box55l"}],["path",{d:"m22 7-8.5 8.5-5-5L2 17",key:"1t1m79"}]]),R=j("play",[["path",{d:"M5 5a2 2 0 0 1 3.008-1.728l11.997 6.998a2 2 0 0 1 .003 3.458l-12 7A2 2 0 0 1 5 19z",key:"10ikf1"}]]),V=j("circle-check-big",[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]]);var P=()=>{var e,s,t;let[r,i]=(0,l.useState)([]),[d,n]=(0,l.useState)([]),[c,x]=(0,l.useState)(null),[m,h]=(0,l.useState)({}),[u,g]=(0,l.useState)(!0),[p,b]=(0,l.useState)("overview"),[v,y]=(0,l.useState)(null),[j,P]=(0,l.useState)(!1),[T,M]=(0,l.useState)(!1),[O,H]=(0,l.useState)(null),[z,U]=(0,l.useState)([]),[F,B]=(0,l.useState)(!1),[W,G]=(0,l.useState)(""),[q,K]=(0,l.useState)("ALL"),[Y,_]=(0,l.useState)("ALL"),[J,Q]=(0,l.useState)(!1),[Z,$]=(0,l.useState)(null);(0,l.useEffect)(()=>{X(),ee();let e=setInterval(()=>{X(),ee()},6e4);return()=>clearInterval(e)},[]);let X=async()=>{try{g(!0),$(null);let e=await o.getPatches();if(e.success){let s=Array.isArray(e.data)?e.data:[];i(s),Q(e.fromCache||!1)}else throw Error("Failed to load patches");let s=await o.getInventory();if(s.success){let e=Array.isArray(s.data)?s.data:[];n(e)}if(e.fromCache||!e.success){let t=Array.isArray(e.data)?e.data:[],a=Array.isArray(s.data)?s.data:[],l=a.length,r=a.filter(e=>"compliant"===e.patchStatus).length;x({totalPatches:t.length,criticalPatches:t.filter(e=>"CRITICAL"===e.severity).length,pendingDeployments:t.filter(e=>"AVAILABLE"===e.status).length,coverageRate:l>0?r/l*100:0,fullyPatched:r,partiallyPatched:l>0?Math.max(0,l-r-1):0,unpatched:l>0?Math.max(0,l-r):0,criticalExposure:a.filter(e=>{var s;return(null===(s=e.vulnerabilityStats)||void 0===s?void 0:s.critical)>0}).map(e=>{var s,t,a,l;return{deviceName:e.name,cveId:(null===(t=e.topVulnerabilities)||void 0===t?void 0:null===(s=t[0])||void 0===s?void 0:s.cveId)||"N/A",cvssScore:(null===(l=e.topVulnerabilities)||void 0===l?void 0:null===(a=l[0])||void 0===a?void 0:a.cvssScore)||0}})}),h({})}g(!1)}catch(e){console.error("Error loading patch data:",e),$(e.message||"Failed to load patch data"),g(!1),r&&0!==r.length||i([]),d&&0!==d.length||n([])}},ee=async()=>{try{let b=await o.getSchedules("SCHEDULED");if(b.success){let o=b.data.schedules||[];if(0===o.length&&r.length>0){var e,s,t,a,l,i,d,n,c,x,m,h,u,g,p;let o=[{scheduleId:"sample-".concat(Date.now(),"-1"),patchId:(null===(e=r[0])||void 0===e?void 0:e.id)||"KB5034441",patchTitle:(null===(s=r[0])||void 0===s?void 0:s.title)||"Windows Security Update",severity:(null===(t=r[0])||void 0===t?void 0:t.severity)||"CRITICAL",deviceCount:(null===(l=r[0])||void 0===l?void 0:null===(a=l.affectedDevices)||void 0===a?void 0:a.length)||2,scheduledFor:new Date(Date.now()+72e5).toISOString(),status:"SCHEDULED",requestedBy:"admin"},{scheduleId:"sample-".concat(Date.now(),"-2"),patchId:(null===(i=r[1])||void 0===i?void 0:i.id)||"KB5034439",patchTitle:(null===(d=r[1])||void 0===d?void 0:d.title)||"Windows Server Update",severity:(null===(n=r[1])||void 0===n?void 0:n.severity)||"HIGH",deviceCount:(null===(x=r[1])||void 0===x?void 0:null===(c=x.affectedDevices)||void 0===c?void 0:c.length)||3,scheduledFor:new Date(Date.now()+864e5).toISOString(),status:"SCHEDULED",requestedBy:"admin"},{scheduleId:"sample-".concat(Date.now(),"-3"),patchId:(null===(m=r[2])||void 0===m?void 0:m.id)||"UBUNTU-2024-01",patchTitle:(null===(h=r[2])||void 0===h?void 0:h.title)||"Ubuntu Security Update",severity:(null===(u=r[2])||void 0===u?void 0:u.severity)||"MEDIUM",deviceCount:(null===(p=r[2])||void 0===p?void 0:null===(g=p.affectedDevices)||void 0===g?void 0:g.length)||1,scheduledFor:new Date(Date.now()+1728e5).toISOString(),status:"SCHEDULED",requestedBy:"system"}];U(o)}else U(o)}}catch(e){console.error("Error loading schedules:",e),U([])}},es=async e=>{try{let s=await o.analyzePatch({patch:e,devices:d.filter(s=>{var t;return null===(t=e.affectedDevices)||void 0===t?void 0:t.includes(s.id)}),vulnerabilities:e.relatedCVEs});if(s.success)H(s.data),y(e),P(!0);else throw Error("Analysis failed")}catch(e){console.error("AI analysis error:",e),alert("Failed to get AI analysis: "+e.message)}},et=async function(e){let s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;try{if(s){let t=await o.createSchedule({patchId:e.id,patchTitle:e.title,deviceIds:e.affectedDevices||[],scheduledFor:s.scheduledFor||Date.now()+864e5,severity:e.severity,requestedBy:"admin",enableAI:!0});if(t.success)t.data.schedules&&U(t.data.schedules),alert("✅ Patch scheduled successfully for ".concat(new Date(s.scheduledFor||Date.now()+864e5).toLocaleString(),"!\n\n")+"Schedule Count: ".concat(t.data.scheduleCount||0," active schedules\n")+(t.data.aiApproved?"\uD83E\uDD16 AI Auto-Approved (Risk: ".concat(t.data.aiRiskLevel,"/10)"):t.data.aiRecommendation?"⚠️ AI Recommendation: ".concat(t.data.aiRecommendation):"")),P(!1),H(null),X(),ee();else throw Error(t.error||"Failed to create schedule")}else if((await o.deployPatch({patchId:e.id,deviceIds:e.affectedDevices,aiApproved:(null==O?void 0:O.recommendation)==="APPROVE"})).success)alert("✅ Patch deployment initiated successfully!"),P(!1),H(null),X(),ee();else throw Error("Deployment failed")}catch(e){console.error("Deploy error:",e),alert("❌ Failed to deploy patch: "+e.message)}},ea=e=>{y(e),M(!0)},el=()=>r&&Array.isArray(r)?r.filter(e=>{var s,t,a;let l=(null===(s=e.title)||void 0===s?void 0:s.toLowerCase().includes(W.toLowerCase()))||(null===(t=e.description)||void 0===t?void 0:t.toLowerCase().includes(W.toLowerCase()))||(null===(a=e.cveId)||void 0===a?void 0:a.toLowerCase().includes(W.toLowerCase())),r="ALL"===q||e.severity===q,i="ALL"===Y||e.status===Y;return l&&r&&i}):[],er=e=>({CRITICAL:"bg-red-100 text-red-800 border-red-300",HIGH:"bg-orange-100 text-orange-800 border-orange-300",MEDIUM:"bg-yellow-100 text-yellow-800 border-yellow-300",LOW:"bg-blue-100 text-blue-800 border-blue-300"})[e]||"bg-gray-100 text-gray-800 border-gray-300",ei=e=>({AVAILABLE:"bg-green-100 text-green-800 border-green-300",PENDING:"bg-yellow-100 text-yellow-800 border-yellow-300",DEPLOYING:"bg-blue-100 text-blue-800 border-blue-300",DEPLOYED:"bg-gray-100 text-gray-800 border-gray-300",FAILED:"bg-red-100 text-red-800 border-red-300",SCHEDULED:"bg-purple-100 text-purple-800 border-purple-300"})[e]||"bg-gray-100 text-gray-800 border-gray-300";return u?(0,a.jsx)("div",{className:"flex items-center justify-center h-64",children:(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto"}),(0,a.jsx)("p",{className:"mt-4 text-gray-600",children:"Loading patch management system..."})]})}):Z&&!r.length?(0,a.jsx)("div",{className:"flex items-center justify-center h-64",children:(0,a.jsxs)("div",{className:"text-center max-w-md",children:[(0,a.jsx)("div",{className:"text-red-600 mb-4",children:(0,a.jsx)("svg",{className:"w-16 h-16 mx-auto",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,a.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})})}),(0,a.jsx)("p",{className:"text-xl font-bold text-gray-900 mb-2",children:"Error Loading Data"}),(0,a.jsx)("p",{className:"text-gray-600 mb-4",children:Z}),(0,a.jsx)("button",{onClick:()=>{$(null),X(),ee()},className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors",children:"Try Again"})]})}):(0,a.jsxs)("div",{className:"space-y-6",children:[J&&(0,a.jsx)("div",{className:"bg-yellow-50 border-l-4 border-yellow-400 p-4 rounded",children:(0,a.jsxs)("div",{className:"flex",children:[(0,a.jsx)("div",{className:"flex-shrink-0",children:(0,a.jsx)("svg",{className:"h-5 w-5 text-yellow-400",viewBox:"0 0 20 20",fill:"currentColor",children:(0,a.jsx)("path",{fillRule:"evenodd",d:"M8.257 3.099c.765-1.36 2.722-1.36 3.486 0l5.58 9.92c.75 1.334-.213 2.98-1.742 2.98H4.42c-1.53 0-2.493-1.646-1.743-2.98l5.58-9.92zM11 13a1 1 0 11-2 0 1 1 0 012 0zm-1-8a1 1 0 00-1 1v3a1 1 0 002 0V6a1 1 0 00-1-1z",clipRule:"evenodd"})})}),(0,a.jsx)("div",{className:"ml-3",children:(0,a.jsx)("p",{className:"text-sm text-yellow-700",children:"⚠️ Using demo data - API unavailable. Showing sample patches for demonstration."})})]})}),(0,a.jsxs)("div",{className:"bg-white rounded-lg shadow-sm p-6 border border-gray-200",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("h2",{className:"text-2xl font-bold text-gray-900",children:"\uD83D\uDEE1️ World-Class Patch Management"}),(0,a.jsx)("p",{className:"text-sm text-gray-600 mt-1",children:"AI-Powered Intelligent Patch Deployment System"})]}),(0,a.jsxs)("div",{className:"flex items-center gap-3",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2 bg-green-50 px-4 py-2 rounded-lg border border-green-200",children:[(0,a.jsx)("span",{className:"w-2 h-2 bg-green-500 rounded-full animate-pulse"}),(0,a.jsx)("span",{className:"text-sm font-medium text-green-800",children:"AI Active"})]}),(0,a.jsx)("button",{onClick:X,className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors font-medium",children:"\uD83D\uDD04 Refresh"})]})]}),(0,a.jsx)("div",{className:"flex space-x-2 border-b border-gray-200",children:["overview","patches","devices","schedule","compliance"].map(e=>(0,a.jsx)("button",{onClick:()=>b(e),className:"px-6 py-3 font-medium capitalize transition-all duration-200 border-b-2 ".concat(p===e?"border-blue-600 text-blue-600":"border-transparent text-gray-600 hover:text-gray-900"),children:e},e))})]}),"overview"===p&&(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[(0,a.jsxs)("div",{className:"bg-gradient-to-br from-blue-500 to-blue-600 rounded-xl p-6 text-white shadow-lg",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between mb-3",children:[(0,a.jsx)("h3",{className:"text-sm font-medium opacity-90",children:"Total Patches"}),(0,a.jsx)("span",{className:"text-3xl",children:"\uD83D\uDCE6"})]}),(0,a.jsx)("p",{className:"text-4xl font-bold",children:(null==r?void 0:r.length)||0}),(0,a.jsxs)("p",{className:"text-sm opacity-80 mt-2",children:[(null==r?void 0:r.filter(e=>"AVAILABLE"===e.status).length)||0," available"]})]}),(0,a.jsxs)("div",{className:"bg-gradient-to-br from-red-500 to-red-600 rounded-xl p-6 text-white shadow-lg",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between mb-3",children:[(0,a.jsx)("h3",{className:"text-sm font-medium opacity-90",children:"Critical Patches"}),(0,a.jsx)("span",{className:"text-3xl",children:"\uD83D\uDD25"})]}),(0,a.jsx)("p",{className:"text-4xl font-bold",children:(null==r?void 0:r.filter(e=>"CRITICAL"===e.severity).length)||0}),(0,a.jsx)("p",{className:"text-sm opacity-80 mt-2",children:"Requires immediate action"})]}),(0,a.jsxs)("div",{className:"bg-gradient-to-br from-green-500 to-green-600 rounded-xl p-6 text-white shadow-lg",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between mb-3",children:[(0,a.jsx)("h3",{className:"text-sm font-medium opacity-90",children:"Deployed"}),(0,a.jsx)("span",{className:"text-3xl",children:"✅"})]}),(0,a.jsx)("p",{className:"text-4xl font-bold",children:(null==r?void 0:r.filter(e=>"DEPLOYED"===e.status).length)||0}),(0,a.jsx)("p",{className:"text-sm opacity-80 mt-2",children:"Successfully applied"})]}),(0,a.jsxs)("div",{className:"bg-gradient-to-br from-purple-500 to-purple-600 rounded-xl p-6 text-white shadow-lg",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between mb-3",children:[(0,a.jsx)("h3",{className:"text-sm font-medium opacity-90",children:"Scheduled"}),(0,a.jsx)("span",{className:"text-3xl",children:"\uD83D\uDCC5"})]}),(0,a.jsx)("p",{className:"text-4xl font-bold",children:(null==z?void 0:z.length)||0}),(0,a.jsx)("p",{className:"text-sm opacity-80 mt-2",children:"Upcoming deployments"})]})]}),c&&void 0!==c.coverageRate&&(0,a.jsxs)("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6",children:[(0,a.jsx)("h3",{className:"text-lg font-bold text-gray-900 mb-4",children:"\uD83D\uDCCA Patch Coverage Analysis"}),(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsxs)("div",{className:"relative inline-flex items-center justify-center w-32 h-32",children:[(0,a.jsxs)("svg",{className:"w-32 h-32 transform -rotate-90",children:[(0,a.jsx)("circle",{cx:"64",cy:"64",r:"56",stroke:"currentColor",strokeWidth:"8",fill:"none",className:"text-gray-200"}),(0,a.jsx)("circle",{cx:"64",cy:"64",r:"56",stroke:"currentColor",strokeWidth:"8",fill:"none",strokeDasharray:"".concat(2*Math.PI*56),strokeDashoffset:"".concat(2*Math.PI*56*(1-(c.coverageRate||0)/100)),className:"text-green-500"})]}),(0,a.jsxs)("span",{className:"absolute text-2xl font-bold",children:[(c.coverageRate||0).toFixed(1),"%"]})]}),(0,a.jsx)("p",{className:"text-sm font-medium text-gray-700 mt-2",children:"Coverage Rate"})]}),(0,a.jsxs)("div",{className:"space-y-3",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsx)("span",{className:"text-sm text-gray-600",children:"Fully Patched"}),(0,a.jsx)("span",{className:"font-bold text-green-600",children:c.fullyPatched||0})]}),(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsx)("span",{className:"text-sm text-gray-600",children:"Partially Patched"}),(0,a.jsx)("span",{className:"font-bold text-yellow-600",children:c.partiallyPatched||0})]}),(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsx)("span",{className:"text-sm text-gray-600",children:"Unpatched"}),(0,a.jsx)("span",{className:"font-bold text-red-600",children:c.unpatched||0})]})]}),(0,a.jsxs)("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4",children:[(0,a.jsx)("p",{className:"text-sm font-semibold text-red-800 mb-2",children:"Critical Exposure"}),(0,a.jsx)("p",{className:"text-3xl font-bold text-red-600",children:(null===(e=c.criticalExposure)||void 0===e?void 0:e.length)||0}),(0,a.jsx)("p",{className:"text-xs text-red-600 mt-1",children:"Devices with critical vulnerabilities"})]})]})]}),(0,a.jsxs)("div",{className:"bg-gradient-to-br from-indigo-50 to-purple-50 rounded-lg border border-indigo-200 p-6",children:[(0,a.jsxs)("div",{className:"flex items-center gap-3 mb-4",children:[(0,a.jsx)("span",{className:"text-3xl",children:"\uD83E\uDD16"}),(0,a.jsxs)("div",{children:[(0,a.jsx)("h3",{className:"text-lg font-bold text-gray-900",children:"AI-Powered Recommendations"}),(0,a.jsx)("p",{className:"text-sm text-gray-600",children:"Intelligent deployment suggestions"})]})]}),(0,a.jsx)("div",{className:"space-y-3",children:null==r?void 0:r.filter(e=>"CRITICAL"===e.severity&&"AVAILABLE"===e.status).slice(0,3).map(e=>{var s;return(0,a.jsx)("div",{className:"bg-white rounded-lg p-4 border border-indigo-200",children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{className:"flex-1",children:[(0,a.jsx)("p",{className:"font-semibold text-gray-900",children:e.title}),(0,a.jsxs)("p",{className:"text-sm text-gray-600 mt-1",children:[(null===(s=e.affectedDevices)||void 0===s?void 0:s.length)||0," devices affected"]})]}),(0,a.jsx)("button",{onClick:()=>es(e),className:"px-4 py-2 bg-indigo-600 text-white rounded-lg hover:bg-indigo-700 transition-colors text-sm font-medium",children:"Analyze & Deploy"})]})},e.id)})})]})]}),"patches"===p&&(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsxs)("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-4",children:[(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[(0,a.jsx)("div",{className:"md:col-span-2",children:(0,a.jsxs)("div",{className:"relative",children:[(0,a.jsx)(f,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400",size:20}),(0,a.jsx)("input",{type:"text",placeholder:"Search patches by title, CVE, or description...",value:W,onChange:e=>G(e.target.value),className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]})}),(0,a.jsx)("div",{children:(0,a.jsxs)("select",{value:q,onChange:e=>K(e.target.value),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[(0,a.jsx)("option",{value:"ALL",children:"All Severities"}),(0,a.jsx)("option",{value:"CRITICAL",children:"Critical"}),(0,a.jsx)("option",{value:"HIGH",children:"High"}),(0,a.jsx)("option",{value:"MEDIUM",children:"Medium"}),(0,a.jsx)("option",{value:"LOW",children:"Low"})]})}),(0,a.jsx)("div",{children:(0,a.jsxs)("select",{value:Y,onChange:e=>_(e.target.value),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[(0,a.jsx)("option",{value:"ALL",children:"All Status"}),(0,a.jsx)("option",{value:"AVAILABLE",children:"Available"}),(0,a.jsx)("option",{value:"PENDING",children:"Pending"}),(0,a.jsx)("option",{value:"DEPLOYING",children:"Deploying"}),(0,a.jsx)("option",{value:"DEPLOYED",children:"Deployed"}),(0,a.jsx)("option",{value:"FAILED",children:"Failed"}),(0,a.jsx)("option",{value:"SCHEDULED",children:"Scheduled"})]})})]}),(0,a.jsxs)("div",{className:"mt-3 flex items-center justify-between text-sm text-gray-600",children:[(0,a.jsxs)("span",{children:["Showing ",el().length," of ",r.length," patches"]}),(0,a.jsxs)("button",{onClick:X,className:"flex items-center gap-2 px-3 py-1 text-blue-600 hover:bg-blue-50 rounded-lg transition-colors",children:[(0,a.jsx)(N,{size:16}),"Refresh"]})]})]}),0===el().length?(0,a.jsxs)("div",{className:"bg-white rounded-lg shadow-sm p-8 text-center border border-gray-200",children:[(0,a.jsx)(w,{className:"mx-auto mb-4 text-gray-400",size:48}),(0,a.jsx)("p",{className:"text-gray-600 font-medium mb-2",children:"No patches found"}),(0,a.jsx)("p",{className:"text-sm text-gray-500",children:"Try adjusting your search or filters"})]}):el().map(e=>{var s;return(0,a.jsx)("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 hover:shadow-md transition-all",children:(0,a.jsxs)("div",{className:"p-6",children:[(0,a.jsx)("div",{className:"flex items-start justify-between mb-4",children:(0,a.jsxs)("div",{className:"flex-1",children:[(0,a.jsxs)("div",{className:"flex items-center gap-3 mb-2",children:[(0,a.jsx)(w,{className:"text-blue-600",size:20}),(0,a.jsx)("h3",{className:"text-lg font-bold text-gray-900",children:e.title}),(0,a.jsx)("span",{className:"px-3 py-1 rounded-full text-xs font-bold border ".concat(er(e.severity)),children:e.severity}),(0,a.jsx)("span",{className:"px-3 py-1 rounded-full text-xs font-bold border ".concat(ei(e.status)),children:e.status})]}),(0,a.jsx)("p",{className:"text-gray-700 mb-3",children:e.description}),(0,a.jsxs)("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 text-sm",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)(S,{className:"text-gray-400",size:16}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-gray-500 text-xs",children:"Released"}),(0,a.jsx)("p",{className:"font-medium text-gray-900",children:new Date(e.releaseDate).toLocaleDateString()})]})]}),(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)(D,{className:"text-gray-400",size:16}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-gray-500 text-xs",children:"Affected Devices"}),(0,a.jsxs)("p",{className:"font-medium text-gray-900",children:[(null===(s=e.affectedDevices)||void 0===s?void 0:s.length)||0," devices"]})]})]}),(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)(C,{className:"text-gray-400",size:16}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-gray-500 text-xs",children:"Size"}),(0,a.jsx)("p",{className:"font-medium text-gray-900",children:e.size||"Unknown"})]})]}),(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)(I,{className:"text-gray-400",size:16}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-gray-500 text-xs",children:"Vendor"}),(0,a.jsx)("p",{className:"font-medium text-gray-900",children:e.vendor||"Unknown"})]})]})]})]})}),e.relatedCVEs&&e.relatedCVEs.length>0&&(0,a.jsxs)("div",{className:"bg-red-50 border border-red-200 rounded-lg p-3 mb-4",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2 mb-2",children:[(0,a.jsx)(A,{className:"text-red-600",size:16}),(0,a.jsx)("p",{className:"text-sm font-semibold text-red-800",children:"Related Vulnerabilities"})]}),(0,a.jsx)("div",{className:"flex flex-wrap gap-2",children:e.relatedCVEs.map((e,s)=>(0,a.jsx)("span",{className:"px-2 py-1 bg-white text-red-800 rounded text-xs font-mono border border-red-200 hover:bg-red-100 transition-colors cursor-pointer",children:e},s))})]}),m[e.id]&&(0,a.jsxs)("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-3 mb-4",children:[(0,a.jsx)("p",{className:"text-sm font-semibold text-blue-800 mb-2",children:"Patch Details"}),(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-3 text-sm",children:[void 0!==m[e.id].requiresReboot&&(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)("span",{className:"text-blue-600",children:"\uD83D\uDD04"}),(0,a.jsxs)("span",{className:"text-gray-700",children:["Reboot: ",m[e.id].requiresReboot?"Required":"Not Required"]})]}),m[e.id].installTime&&(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)(k,{className:"text-blue-600",size:14}),(0,a.jsxs)("span",{className:"text-gray-700",children:["Install Time: ",m[e.id].installTime]})]})]})]}),(0,a.jsxs)("div",{className:"flex gap-2 pt-4 border-t border-gray-200 flex-wrap",children:[(0,a.jsxs)("button",{onClick:()=>ea(e),className:"flex items-center gap-2 px-4 py-2 bg-gray-100 text-gray-700 rounded-lg hover:bg-gray-200 transition-colors text-sm font-medium",children:[(0,a.jsx)(E,{size:16}),"View Details"]}),"AVAILABLE"===e.status&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("button",{onClick:()=>es(e),className:"flex items-center gap-2 px-4 py-2 bg-gradient-to-r from-indigo-600 to-purple-600 text-white rounded-lg hover:from-indigo-700 hover:to-purple-700 transition-all text-sm font-medium shadow-md",children:[(0,a.jsx)(L,{size:16}),"AI Analysis & Deploy"]}),(0,a.jsxs)("button",{onClick:()=>{et(e,{scheduledFor:Date.now()+864e5})},className:"flex items-center gap-2 px-4 py-2 bg-purple-600 text-white rounded-lg hover:bg-purple-700 transition-colors text-sm font-medium",children:[(0,a.jsx)(S,{size:16}),"Schedule for Later"]}),(0,a.jsxs)("button",{onClick:()=>{y(e),H(null),P(!0)},className:"flex items-center gap-2 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors text-sm font-medium",children:[(0,a.jsx)(R,{size:16}),"Deploy Now"]})]}),"DEPLOYED"===e.status&&(0,a.jsxs)("button",{className:"flex items-center gap-2 px-4 py-2 bg-green-100 text-green-700 rounded-lg text-sm font-medium cursor-default",children:[(0,a.jsx)(V,{size:16}),"Deployed"]}),"SCHEDULED"===e.status&&(0,a.jsxs)("button",{className:"flex items-center gap-2 px-4 py-2 bg-purple-100 text-purple-700 rounded-lg text-sm font-medium cursor-default",children:[(0,a.jsx)(S,{size:16}),"Scheduled"]}),"DEPLOYING"===e.status&&(0,a.jsxs)("button",{className:"flex items-center gap-2 px-4 py-2 bg-yellow-100 text-yellow-700 rounded-lg text-sm font-medium cursor-default",children:[(0,a.jsx)(N,{className:"animate-spin",size:16}),"Deploying..."]})]})]})},e.id)})]}),"devices"===p&&(0,a.jsx)("div",{className:"space-y-4",children:null==d?void 0:d.map(e=>{var s;let t=(null==r?void 0:r.filter(s=>{var t;return null===(t=s.affectedDevices)||void 0===t?void 0:t.includes(e.id)}))||[],l=t.filter(e=>"AVAILABLE"===e.status);return(0,a.jsx)("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6",children:(0,a.jsx)("div",{className:"flex items-start justify-between",children:(0,a.jsxs)("div",{className:"flex-1",children:[(0,a.jsx)("h3",{className:"text-lg font-bold text-gray-900",children:e.name}),(0,a.jsx)("p",{className:"text-sm text-gray-600",children:e.operatingSystem}),(0,a.jsxs)("div",{className:"mt-4 grid grid-cols-3 gap-4",children:[(0,a.jsxs)("div",{className:"bg-gray-50 rounded-lg p-3",children:[(0,a.jsx)("p",{className:"text-sm text-gray-600",children:"Total Patches"}),(0,a.jsx)("p",{className:"text-2xl font-bold text-gray-900",children:t.length})]}),(0,a.jsxs)("div",{className:"bg-yellow-50 rounded-lg p-3",children:[(0,a.jsx)("p",{className:"text-sm text-yellow-600",children:"Pending"}),(0,a.jsx)("p",{className:"text-2xl font-bold text-yellow-600",children:l.length})]}),(0,a.jsxs)("div",{className:"bg-red-50 rounded-lg p-3",children:[(0,a.jsx)("p",{className:"text-sm text-red-600",children:"Vulnerabilities"}),(0,a.jsx)("p",{className:"text-2xl font-bold text-red-600",children:(null===(s=e.vulnerabilityStats)||void 0===s?void 0:s.total)||0})]})]})]})})},e.id)})}),"schedule"===p&&(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[(0,a.jsxs)("div",{className:"bg-gradient-to-br from-purple-500 to-purple-600 rounded-xl shadow-lg p-6 text-white",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between mb-3",children:[(0,a.jsx)(S,{size:28}),(0,a.jsx)("span",{className:"text-3xl font-bold",children:(null==z?void 0:z.length)||0})]}),(0,a.jsx)("p",{className:"text-purple-100 text-sm font-medium",children:"Total Scheduled"}),(0,a.jsx)("p",{className:"text-purple-200 text-xs mt-1",children:"Active patch schedules"})]}),(0,a.jsxs)("div",{className:"bg-gradient-to-br from-blue-500 to-blue-600 rounded-xl shadow-lg p-6 text-white",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between mb-3",children:[(0,a.jsx)(k,{size:28}),(0,a.jsx)("span",{className:"text-3xl font-bold",children:(null==z?void 0:z.filter(e=>new Date(e.scheduledFor)<new Date(Date.now()+864e5)).length)||0})]}),(0,a.jsx)("p",{className:"text-blue-100 text-sm font-medium",children:"Next 24 Hours"}),(0,a.jsx)("p",{className:"text-blue-200 text-xs mt-1",children:"Upcoming deployments"})]}),(0,a.jsxs)("div",{className:"bg-gradient-to-br from-red-500 to-red-600 rounded-xl shadow-lg p-6 text-white",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between mb-3",children:[(0,a.jsx)(A,{size:28}),(0,a.jsx)("span",{className:"text-3xl font-bold",children:(null==z?void 0:z.filter(e=>"CRITICAL"===e.severity).length)||0})]}),(0,a.jsx)("p",{className:"text-red-100 text-sm font-medium",children:"Critical Patches"}),(0,a.jsx)("p",{className:"text-red-200 text-xs mt-1",children:"High priority items"})]}),(0,a.jsxs)("div",{className:"bg-gradient-to-br from-green-500 to-green-600 rounded-xl shadow-lg p-6 text-white",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between mb-3",children:[(0,a.jsx)(D,{size:28}),(0,a.jsx)("span",{className:"text-3xl font-bold",children:(null==z?void 0:z.reduce((e,s)=>e+(s.deviceCount||0),0))||0})]}),(0,a.jsx)("p",{className:"text-green-100 text-sm font-medium",children:"Total Devices"}),(0,a.jsx)("p",{className:"text-green-200 text-xs mt-1",children:"Affected endpoints"})]})]}),(0,a.jsxs)("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-6",children:[(0,a.jsxs)("h3",{className:"text-lg font-bold text-gray-900 mb-4 flex items-center gap-2",children:[(0,a.jsx)(L,{size:20,className:"text-blue-600"}),"Schedule Distribution by Severity"]}),(0,a.jsx)("div",{className:"grid grid-cols-4 gap-4",children:["CRITICAL","HIGH","MEDIUM","LOW"].map(e=>{let s=(null==z?void 0:z.filter(s=>s.severity===e).length)||0,t=(s/((null==z?void 0:z.length)||1)*100).toFixed(0);return(0,a.jsx)("div",{className:"text-center",children:(0,a.jsxs)("div",{className:"relative pt-1 ".concat("CRITICAL"===e?"text-red-600":"HIGH"===e?"text-orange-600":"MEDIUM"===e?"text-yellow-600":"text-blue-600"),children:[(0,a.jsx)("div",{className:"flex mb-2 items-center justify-center",children:(0,a.jsx)("span",{className:"text-3xl font-bold",children:s})}),(0,a.jsx)("div",{className:"w-full bg-gray-200 rounded-full h-2 mb-2",children:(0,a.jsx)("div",{className:"h-2 rounded-full ".concat("CRITICAL"===e?"bg-red-600":"HIGH"===e?"bg-orange-600":"MEDIUM"===e?"bg-yellow-600":"bg-blue-600"),style:{width:"".concat(t,"%")}})}),(0,a.jsx)("span",{className:"text-xs font-semibold uppercase",children:e}),(0,a.jsxs)("p",{className:"text-xs text-gray-500 mt-1",children:[t,"% of total"]})]})},e)})})]}),z&&z.length>0&&(0,a.jsxs)("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-6",children:[(0,a.jsxs)("h3",{className:"text-lg font-bold text-gray-900 mb-4 flex items-center gap-2",children:[(0,a.jsx)(I,{size:20,className:"text-blue-600"}),"Deployment Timeline"]}),(0,a.jsx)("div",{className:"space-y-3",children:z.sort((e,s)=>new Date(e.scheduledFor)-new Date(s.scheduledFor)).slice(0,5).map((e,s)=>{let t=new Date(e.scheduledFor),l=new Date,r=((t-l)/36e5).toFixed(1),i=t<l;return(0,a.jsxs)("div",{className:"flex items-center gap-4 p-4 bg-gray-50 rounded-lg border border-gray-200",children:[(0,a.jsxs)("div",{className:"flex-shrink-0 w-20 text-center",children:[(0,a.jsx)("div",{className:"text-2xl font-bold ".concat(i?"text-red-600":"text-blue-600"),children:t.getDate()}),(0,a.jsx)("div",{className:"text-xs text-gray-600",children:t.toLocaleDateString("en-US",{month:"short"})}),(0,a.jsx)("div",{className:"text-xs text-gray-500",children:t.toLocaleTimeString("en-US",{hour:"2-digit",minute:"2-digit"})})]}),(0,a.jsxs)("div",{className:"flex-1",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2 mb-1",children:[(0,a.jsx)("span",{className:"px-2 py-0.5 rounded-full text-xs font-bold ".concat(er(e.severity)),children:e.severity}),(0,a.jsx)("span",{className:"font-semibold text-gray-900",children:e.patchTitle})]}),(0,a.jsxs)("div",{className:"flex items-center gap-4 text-xs text-gray-600",children:[(0,a.jsxs)("span",{className:"flex items-center gap-1",children:[(0,a.jsx)(D,{size:14}),e.deviceCount," devices"]}),(0,a.jsxs)("span",{className:"flex items-center gap-1",children:[(0,a.jsx)(k,{size:14}),i?"Overdue":"In ".concat(r,"h")]}),e.requestedBy&&(0,a.jsxs)("span",{className:"flex items-center gap-1",children:["\uD83D\uDC64 ",e.requestedBy]})]})]})]},s)})})]}),z&&0!==z.length?(0,a.jsxs)("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 overflow-hidden",children:[(0,a.jsx)("div",{className:"p-6 border-b border-gray-200",children:(0,a.jsxs)("h3",{className:"text-lg font-bold text-gray-900 flex items-center gap-2",children:[(0,a.jsx)(S,{size:20,className:"text-blue-600"}),"All Scheduled Deployments (",z.length,")"]})}),(0,a.jsx)("div",{className:"overflow-x-auto",children:(0,a.jsxs)("table",{className:"w-full",children:[(0,a.jsx)("thead",{className:"bg-gray-50",children:(0,a.jsxs)("tr",{children:[(0,a.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Patch"}),(0,a.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Severity"}),(0,a.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Scheduled For"}),(0,a.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Devices"}),(0,a.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Status"}),(0,a.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Actions"})]})}),(0,a.jsx)("tbody",{className:"bg-white divide-y divide-gray-200",children:z.map((e,s)=>{let t=new Date(e.scheduledFor),l=e.status||"SCHEDULED";return(0,a.jsxs)("tr",{className:"hover:bg-gray-50 transition-colors",children:[(0,a.jsxs)("td",{className:"px-6 py-4 whitespace-nowrap",children:[(0,a.jsx)("div",{className:"text-sm font-medium text-gray-900",children:e.patchTitle||e.patchId}),e.patchId&&(0,a.jsxs)("div",{className:"text-xs text-gray-500",children:["ID: ",e.patchId]})]}),(0,a.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,a.jsx)("span",{className:"px-3 py-1 rounded-full text-xs font-bold ".concat(er(e.severity)),children:e.severity})}),(0,a.jsxs)("td",{className:"px-6 py-4 whitespace-nowrap",children:[(0,a.jsx)("div",{className:"text-sm text-gray-900",children:t.toLocaleDateString()}),(0,a.jsx)("div",{className:"text-xs text-gray-500",children:t.toLocaleTimeString()})]}),(0,a.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,a.jsxs)("div",{className:"flex items-center gap-1 text-sm text-gray-900",children:[(0,a.jsx)(D,{size:14,className:"text-gray-500"}),e.deviceCount||0]})}),(0,a.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,a.jsx)("span",{className:"px-3 py-1 rounded-full text-xs font-bold ".concat(ei(l)),children:l})}),(0,a.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm",children:(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)("button",{onClick:()=>{e.scheduleId?o.cancelSchedule(e.scheduleId).then(e=>{e.success&&(e.data.schedules&&U(e.data.schedules),alert("✅ Schedule cancelled successfully!\n\nRemaining schedules: ".concat(e.data.scheduleCount||0)),ee(),X())}).catch(e=>{console.error("Cancel error:",e),alert("❌ Failed to cancel schedule")}):(U(z.filter((e,t)=>t!==s)),alert("Schedule removed from list"))},className:"px-3 py-1.5 bg-red-600 text-white rounded hover:bg-red-700 transition-colors font-medium",children:"Cancel"}),e.scheduleId&&(0,a.jsx)("button",{onClick:()=>{o.getScheduleDetails(e.scheduleId).then(e=>{e.success&&alert(JSON.stringify(e.schedule,null,2))})},className:"px-3 py-1.5 bg-gray-200 text-gray-700 rounded hover:bg-gray-300 transition-colors font-medium",children:"Details"})]})})]},s)})})]})})]}):(0,a.jsxs)("div",{className:"bg-white rounded-xl shadow-sm p-12 text-center border border-gray-200",children:[(0,a.jsx)(S,{size:64,className:"mx-auto text-gray-300 mb-4"}),(0,a.jsx)("p",{className:"text-xl font-bold text-gray-700 mb-2",children:"No Scheduled Deployments"}),(0,a.jsx)("p",{className:"text-gray-500 mb-6",children:"Get started by scheduling patches from the Patches tab"}),(0,a.jsxs)("button",{onClick:()=>b("patches"),className:"px-6 py-3 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors font-medium inline-flex items-center gap-2",children:[(0,a.jsx)(w,{size:18}),"View Available Patches"]})]})]}),"compliance"===p&&(0,a.jsx)("div",{className:"space-y-6",children:c&&void 0!==c.coverageRate?(0,a.jsx)(a.Fragment,{children:(0,a.jsxs)("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6",children:[(0,a.jsx)("h3",{className:"text-lg font-bold text-gray-900 mb-4",children:"\uD83D\uDCCB Compliance Status"}),(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between pb-4 border-b border-gray-200",children:[(0,a.jsx)("span",{className:"font-medium text-gray-700",children:"Overall Patch Compliance"}),(0,a.jsxs)("span",{className:"text-2xl font-bold ".concat(c.coverageRate>=90?"text-green-600":c.coverageRate>=70?"text-yellow-600":"text-red-600"),children:[c.coverageRate.toFixed(1),"%"]})]}),(0,a.jsxs)("div",{className:"grid grid-cols-3 gap-4",children:[(0,a.jsxs)("div",{className:"bg-green-50 rounded-lg p-4 text-center",children:[(0,a.jsx)("p",{className:"text-3xl font-bold text-green-600",children:c.fullyPatched||0}),(0,a.jsx)("p",{className:"text-sm text-green-700 mt-1",children:"Fully Patched"})]}),(0,a.jsxs)("div",{className:"bg-yellow-50 rounded-lg p-4 text-center",children:[(0,a.jsx)("p",{className:"text-3xl font-bold text-yellow-600",children:c.partiallyPatched||0}),(0,a.jsx)("p",{className:"text-sm text-yellow-700 mt-1",children:"Partially Patched"})]}),(0,a.jsxs)("div",{className:"bg-red-50 rounded-lg p-4 text-center",children:[(0,a.jsx)("p",{className:"text-3xl font-bold text-red-600",children:c.unpatched||0}),(0,a.jsx)("p",{className:"text-sm text-red-700 mt-1",children:"Unpatched"})]})]}),c.criticalExposure&&c.criticalExposure.length>0&&(0,a.jsxs)("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4 mt-4",children:[(0,a.jsxs)("h4",{className:"font-semibold text-red-800 mb-3 flex items-center gap-2",children:[(0,a.jsx)(A,{size:20}),"Critical Compliance Issues (",c.criticalExposure.length,")"]}),(0,a.jsx)("div",{className:"space-y-2",children:c.criticalExposure.map((e,s)=>(0,a.jsxs)("div",{className:"bg-white rounded p-3 border border-red-200",children:[(0,a.jsx)("p",{className:"font-medium text-gray-900",children:e.deviceName}),(0,a.jsxs)("p",{className:"text-sm text-red-600",children:[e.cveId," - CVSS ",e.cvssScore]})]},s))})]})]})]})}):(0,a.jsxs)("div",{className:"bg-white rounded-lg shadow-sm p-8 text-center border border-gray-200",children:[(0,a.jsx)(w,{size:48,className:"mx-auto text-gray-400 mb-3"}),(0,a.jsx)("p",{className:"text-gray-600 font-medium",children:"Compliance data not available"}),(0,a.jsx)("p",{className:"text-sm text-gray-500 mt-2",children:"Patch analysis is currently unavailable. Try refreshing the data."})]})}),T&&v&&(0,a.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:(0,a.jsxs)("div",{className:"bg-white rounded-xl shadow-2xl max-w-4xl w-full max-h-[90vh] overflow-y-auto",children:[(0,a.jsx)("div",{className:"bg-gradient-to-r from-blue-600 to-indigo-600 text-white p-6 sticky top-0 z-10",children:(0,a.jsxs)("div",{className:"flex items-start justify-between",children:[(0,a.jsxs)("div",{children:[(0,a.jsxs)("div",{className:"flex items-center gap-3 mb-2",children:[(0,a.jsx)(w,{size:28}),(0,a.jsx)("h2",{className:"text-2xl font-bold",children:v.title})]}),(0,a.jsxs)("div",{className:"flex items-center gap-2 mt-2",children:[(0,a.jsx)("span",{className:"px-3 py-1 rounded-full text-xs font-bold ".concat(er(v.severity)," bg-white bg-opacity-90"),children:v.severity}),(0,a.jsx)("span",{className:"px-3 py-1 rounded-full text-xs font-bold ".concat(ei(v.status)," bg-white bg-opacity-90"),children:v.status})]})]}),(0,a.jsx)("button",{onClick:()=>M(!1),className:"text-white hover:bg-white hover:bg-opacity-20 rounded-lg p-2 transition-colors",children:(0,a.jsx)("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,a.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]})}),(0,a.jsxs)("div",{className:"p-6 space-y-6",children:[(0,a.jsxs)("div",{children:[(0,a.jsxs)("h3",{className:"text-lg font-bold text-gray-900 mb-2 flex items-center gap-2",children:[(0,a.jsx)(I,{size:20,className:"text-blue-600"}),"Description"]}),(0,a.jsx)("p",{className:"text-gray-700 leading-relaxed",children:v.description})]}),(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,a.jsxs)("div",{className:"bg-gray-50 rounded-lg p-4",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2 mb-3",children:[(0,a.jsx)(S,{size:18,className:"text-gray-600"}),(0,a.jsx)("h4",{className:"font-semibold text-gray-900",children:"Release Information"})]}),(0,a.jsxs)("div",{className:"space-y-2 text-sm",children:[(0,a.jsxs)("div",{className:"flex justify-between",children:[(0,a.jsx)("span",{className:"text-gray-600",children:"Release Date:"}),(0,a.jsx)("span",{className:"font-medium text-gray-900",children:new Date(v.releaseDate).toLocaleDateString()})]}),(0,a.jsxs)("div",{className:"flex justify-between",children:[(0,a.jsx)("span",{className:"text-gray-600",children:"Vendor:"}),(0,a.jsx)("span",{className:"font-medium text-gray-900",children:v.vendor||"Unknown"})]}),(0,a.jsxs)("div",{className:"flex justify-between",children:[(0,a.jsx)("span",{className:"text-gray-600",children:"Patch Size:"}),(0,a.jsx)("span",{className:"font-medium text-gray-900",children:v.size||"Unknown"})]})]})]}),(0,a.jsxs)("div",{className:"bg-gray-50 rounded-lg p-4",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2 mb-3",children:[(0,a.jsx)(D,{size:18,className:"text-gray-600"}),(0,a.jsx)("h4",{className:"font-semibold text-gray-900",children:"Deployment Information"})]}),(0,a.jsxs)("div",{className:"space-y-2 text-sm",children:[(0,a.jsxs)("div",{className:"flex justify-between",children:[(0,a.jsx)("span",{className:"text-gray-600",children:"Affected Devices:"}),(0,a.jsx)("span",{className:"font-medium text-gray-900",children:(null===(s=v.affectedDevices)||void 0===s?void 0:s.length)||0})]}),(0,a.jsxs)("div",{className:"flex justify-between",children:[(0,a.jsx)("span",{className:"text-gray-600",children:"Requires Reboot:"}),(0,a.jsx)("span",{className:"font-medium text-gray-900",children:v.requiresReboot?"Yes":"No"})]}),(0,a.jsxs)("div",{className:"flex justify-between",children:[(0,a.jsx)("span",{className:"text-gray-600",children:"Current Status:"}),(0,a.jsx)("span",{className:"font-medium text-gray-900",children:v.status})]})]})]})]}),v.relatedCVEs&&v.relatedCVEs.length>0&&(0,a.jsxs)("div",{className:"bg-red-50 border-2 border-red-200 rounded-lg p-4",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2 mb-3",children:[(0,a.jsx)(A,{size:20,className:"text-red-600"}),(0,a.jsx)("h3",{className:"text-lg font-bold text-red-800",children:"Related Vulnerabilities"})]}),(0,a.jsx)("div",{className:"space-y-3",children:v.relatedCVEs.map((e,s)=>(0,a.jsxs)("div",{className:"bg-white rounded-lg p-3 border border-red-200",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,a.jsx)("span",{className:"font-mono font-bold text-red-800",children:e}),(0,a.jsx)("a",{href:"https://nvd.nist.gov/vuln/detail/".concat(e),target:"_blank",rel:"noopener noreferrer",className:"text-blue-600 hover:text-blue-800 text-sm font-medium",children:"View on NVD →"})]}),(0,a.jsx)("p",{className:"text-sm text-gray-600",children:"Click to view full CVE details on NVD database"})]},s))})]}),v.affectedDevices&&v.affectedDevices.length>0&&(0,a.jsxs)("div",{className:"bg-blue-50 border-2 border-blue-200 rounded-lg p-4",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2 mb-3",children:[(0,a.jsx)(D,{size:20,className:"text-blue-600"}),(0,a.jsx)("h3",{className:"text-lg font-bold text-blue-800",children:"Affected Devices"})]}),(0,a.jsx)("div",{className:"space-y-2",children:v.affectedDevices.map(e=>{let s=d.find(s=>s.id===e);return s?(0,a.jsxs)("div",{className:"bg-white rounded-lg p-3 border border-blue-200 flex items-center justify-between",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"font-semibold text-gray-900",children:s.name}),(0,a.jsxs)("p",{className:"text-sm text-gray-600",children:[s.operatingSystem," • ",s.ipAddress]})]}),(0,a.jsxs)("span",{className:"px-3 py-1 rounded-full text-xs font-bold ".concat(s.riskScore>=8?"bg-red-100 text-red-800":s.riskScore>=6?"bg-yellow-100 text-yellow-800":"bg-green-100 text-green-800"),children:["Risk: ",s.riskScore]})]},e):(0,a.jsx)("div",{className:"bg-white rounded-lg p-3 border border-blue-200",children:(0,a.jsxs)("p",{className:"text-gray-600",children:["Device ID: ",e]})},e)})})]}),(0,a.jsxs)("div",{className:"flex gap-3 pt-4 border-t-2 border-gray-200",children:["AVAILABLE"===v.status&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("button",{onClick:()=>{M(!1),es(v)},className:"flex-1 flex items-center justify-center gap-2 py-3 bg-gradient-to-r from-indigo-600 to-purple-600 text-white rounded-lg font-bold hover:from-indigo-700 hover:to-purple-700 transition-all shadow-md",children:[(0,a.jsx)(L,{size:20}),"AI Analysis & Deploy"]}),(0,a.jsxs)("button",{onClick:()=>{M(!1),H(null),P(!0)},className:"flex-1 flex items-center justify-center gap-2 py-3 bg-blue-600 text-white rounded-lg font-bold hover:bg-blue-700 transition-colors",children:[(0,a.jsx)(R,{size:20}),"Manual Deploy"]})]}),(0,a.jsx)("button",{onClick:()=>M(!1),className:"px-6 py-3 bg-gray-200 text-gray-700 rounded-lg font-bold hover:bg-gray-300 transition-colors",children:"Close"})]})]})]})}),j&&v&&(0,a.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:(0,a.jsxs)("div",{className:"bg-white rounded-lg shadow-2xl max-w-3xl w-full max-h-[90vh] overflow-y-auto",children:[(0,a.jsxs)("div",{className:"sticky top-0 bg-gradient-to-r from-indigo-600 to-purple-600 text-white px-6 py-4 flex justify-between items-center",children:[(0,a.jsxs)("div",{children:[(0,a.jsxs)("h2",{className:"text-2xl font-bold",children:["Deploy Patch: ",v.title]}),(0,a.jsx)("p",{className:"text-sm opacity-90",children:"AI-Powered Deployment Analysis"})]}),(0,a.jsx)("button",{onClick:()=>{P(!1),H(null)},className:"text-white hover:bg-white hover:bg-opacity-20 rounded-lg p-2",children:(0,a.jsx)("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,a.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),(0,a.jsx)("div",{className:"p-6 space-y-6",children:O?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("div",{className:"rounded-lg p-4 border-2 ".concat("APPROVE"===O.recommendation?"bg-green-50 border-green-300":"REVIEW"===O.recommendation?"bg-yellow-50 border-yellow-300":"bg-red-50 border-red-300"),children:(0,a.jsxs)("div",{className:"flex items-center gap-3 mb-2",children:[(0,a.jsx)("span",{className:"text-3xl",children:"APPROVE"===O.recommendation?"✅":"REVIEW"===O.recommendation?"⚠️":"❌"}),(0,a.jsxs)("div",{children:[(0,a.jsxs)("p",{className:"font-bold text-lg",children:["AI Recommendation: ",O.recommendation]}),(0,a.jsx)("p",{className:"text-sm opacity-80",children:O.reasoning})]})]})}),(0,a.jsxs)("div",{className:"bg-gray-50 rounded-lg p-4",children:[(0,a.jsx)("h3",{className:"font-bold text-gray-900 mb-3",children:"Risk Assessment"}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsxs)("div",{className:"flex justify-between",children:[(0,a.jsx)("span",{className:"text-gray-700",children:"Deployment Risk:"}),(0,a.jsxs)("span",{className:"font-bold",children:[O.riskLevel,"/10"]})]}),(0,a.jsxs)("div",{className:"flex justify-between",children:[(0,a.jsx)("span",{className:"text-gray-700",children:"Business Impact:"}),(0,a.jsx)("span",{className:"font-bold",children:O.businessImpact})]}),(0,a.jsxs)("div",{className:"flex justify-between",children:[(0,a.jsx)("span",{className:"text-gray-700",children:"Confidence Score:"}),(0,a.jsxs)("span",{className:"font-bold",children:[(100*O.confidence).toFixed(1),"%"]})]})]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("h3",{className:"font-bold text-gray-900 mb-3",children:"Recommended Deployment Plan"}),(0,a.jsx)("ol",{className:"space-y-2",children:null===(t=O.deploymentSteps)||void 0===t?void 0:t.map((e,s)=>(0,a.jsxs)("li",{className:"flex gap-3",children:[(0,a.jsxs)("span",{className:"font-bold text-indigo-600",children:[s+1,"."]}),(0,a.jsx)("span",{className:"text-gray-700",children:e})]},s))})]}),(0,a.jsxs)("div",{className:"flex gap-3 pt-4 border-t border-gray-200",children:[(0,a.jsx)("button",{onClick:()=>et(v),className:"flex-1 py-3 bg-green-600 text-white rounded-lg font-bold hover:bg-green-700 transition-colors",children:"Deploy Now"}),(0,a.jsx)("button",{onClick:()=>et(v,{scheduledFor:Date.now()+864e5}),className:"flex-1 py-3 bg-purple-600 text-white rounded-lg font-bold hover:bg-purple-700 transition-colors",children:"Schedule for Later"}),(0,a.jsx)("button",{onClick:()=>{P(!1),H(null)},className:"px-6 py-3 bg-gray-200 text-gray-700 rounded-lg font-bold hover:bg-gray-300 transition-colors",children:"Cancel"})]})]}):(0,a.jsxs)("div",{className:"text-center py-8",children:[(0,a.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-indigo-600 mx-auto mb-4"}),(0,a.jsx)("p",{className:"text-gray-600",children:"AI is analyzing the patch deployment..."})]})})]})})]})};let T=e=>{let{title:s,value:t,icon:l,gradient:r,subtitle:i}=e;return(0,a.jsxs)("div",{className:"bg-gradient-to-br ".concat(r," rounded-xl p-6 text-white shadow-lg transform transition-all duration-300 hover:scale-105 hover:shadow-xl"),children:[(0,a.jsxs)("div",{className:"flex items-center justify-between mb-3",children:[(0,a.jsx)("h3",{className:"text-sm font-medium opacity-90",children:s}),(0,a.jsx)("span",{className:"text-3xl",children:l})]}),(0,a.jsx)("p",{className:"text-4xl font-bold mb-2",children:t}),i&&(0,a.jsx)("p",{className:"text-sm opacity-80",children:i})]})},M=e=>{let{label:s,value:t,trend:l}=e;return(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsx)("p",{className:"text-2xl font-bold text-gray-900",children:t}),(0,a.jsx)("p",{className:"text-sm text-gray-600 mt-1",children:s}),(0,a.jsx)("span",{className:"text-xs font-medium ".concat({up:"text-green-600",down:"text-red-600",stable:"text-gray-600"}[l]),children:{up:"↗",down:"↘",stable:"→"}[l]})]})},O=e=>{let{cves:s,getSeverityColor:t,getSeverityBadge:l,formatTimeAgo:r,full:i=!1}=e;return(0,a.jsxs)("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200",children:[(0,a.jsxs)("div",{className:"p-6 border-b border-gray-200",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsx)("h2",{className:"text-xl font-bold text-gray-900",children:"\uD83D\uDD12 Top Critical Vulnerabilities (NVD)"}),(0,a.jsxs)("span",{className:"px-3 py-1 bg-red-100 text-red-700 rounded-full text-xs font-semibold",children:[s.filter(e=>"CRITICAL"===e.severity).length," Critical"]})]}),(0,a.jsx)("p",{className:"text-sm text-gray-600 mt-1",children:"Latest CVEs from National Vulnerability Database"})]}),(0,a.jsx)("div",{className:"divide-y divide-gray-100",children:s.map((e,s)=>(0,a.jsx)("div",{className:"p-5 hover:bg-gray-50 transition-colors duration-150",children:(0,a.jsxs)("div",{className:"flex items-start justify-between",children:[(0,a.jsxs)("div",{className:"flex-1",children:[(0,a.jsxs)("div",{className:"flex items-center space-x-3 mb-2",children:[(0,a.jsx)("span",{className:"font-mono font-bold text-blue-600",children:e.id}),(0,a.jsx)("span",{className:"px-2 py-1 rounded-full text-xs font-semibold border ".concat(l(e.severity)),children:e.severity}),e.patchAvailable&&(0,a.jsx)("span",{className:"px-2 py-1 bg-green-100 text-green-700 rounded-full text-xs font-semibold",children:"Patch Available"})]}),(0,a.jsx)("p",{className:"text-sm text-gray-700 mb-2",children:e.description}),(0,a.jsxs)("div",{className:"flex items-center space-x-4 text-xs text-gray-500",children:[(0,a.jsxs)("span",{children:["\uD83D\uDCC5 ",r(e.published)]}),(0,a.jsxs)("span",{children:["\uD83D\uDDA5️ ",e.affectedSystems," systems affected"]})]})]}),(0,a.jsxs)("div",{className:"ml-4 text-right",children:[(0,a.jsx)("div",{className:"w-16 h-16 bg-gradient-to-br ".concat(t(e.severity)," rounded-lg flex items-center justify-center shadow-lg"),children:(0,a.jsx)("span",{className:"text-white font-bold text-xl",children:e.cvssScore})}),(0,a.jsx)("p",{className:"text-xs text-gray-500 mt-1",children:"CVSS Score"})]})]})},e.id))})]})},H=e=>{let{alerts:s,getSeverityBadge:t,formatTimeAgo:l}=e;return(0,a.jsxs)("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200",children:[(0,a.jsx)("div",{className:"p-4 border-b border-gray-200",children:(0,a.jsx)("h3",{className:"font-bold text-gray-900",children:"⚠️ Active Alerts"})}),(0,a.jsx)("div",{className:"divide-y divide-gray-100",children:s.map(e=>(0,a.jsxs)("div",{className:"p-4 hover:bg-gray-50 transition-colors duration-150",children:[(0,a.jsxs)("div",{className:"flex items-start justify-between mb-2",children:[(0,a.jsx)("h4",{className:"font-semibold text-gray-900 text-sm",children:e.title}),(0,a.jsx)("span",{className:"px-2 py-1 rounded-full text-xs font-semibold border ".concat(t(e.severity)),children:e.severity})]}),(0,a.jsx)("p",{className:"text-xs text-gray-600 mb-2",children:e.description}),(0,a.jsx)("p",{className:"text-xs text-gray-500",children:l(e.timestamp)})]},e.id))})]})},z=e=>{let{actions:s,formatTimeAgo:t}=e;return(0,a.jsxs)("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200",children:[(0,a.jsx)("div",{className:"p-4 border-b border-gray-200",children:(0,a.jsx)("h3",{className:"font-bold text-gray-900",children:"\uD83E\uDD16 AI Actions"})}),(0,a.jsx)("div",{className:"divide-y divide-gray-100",children:s.map(e=>(0,a.jsxs)("div",{className:"p-4 hover:bg-gray-50 transition-colors duration-150",children:[(0,a.jsxs)("div",{className:"flex items-start justify-between mb-2",children:[(0,a.jsx)("h4",{className:"font-semibold text-gray-900 text-sm",children:e.type}),(0,a.jsx)("span",{className:"px-2 py-1 rounded-full text-xs font-semibold ".concat("completed"===e.status?"bg-green-100 text-green-700":"pending"===e.status?"bg-yellow-100 text-yellow-700":"bg-gray-100 text-gray-700"),children:e.status})]}),(0,a.jsx)("p",{className:"text-xs text-gray-600 mb-2",children:e.description}),(0,a.jsxs)("div",{className:"flex items-center justify-between text-xs text-gray-500",children:[(0,a.jsx)("span",{children:e.agent}),(0,a.jsx)("span",{children:t(e.timestamp)})]})]},e.id))})]})};var U=()=>{let[e,s]=(0,l.useState)({}),[t,r]=(0,l.useState)([]),[i,d]=(0,l.useState)([]),[n,c]=(0,l.useState)([]),[o,h]=(0,l.useState)(null),[u,g]=(0,l.useState)(!0),[p,b]=(0,l.useState)("overview"),[v,y]=(0,l.useState)(!1);(0,l.useEffect)(()=>{j();let e=setInterval(()=>{y(!0),j(),setTimeout(()=>y(!1),500)},3e4);return()=>clearInterval(e)},[]);let j=async()=>{try{await new Promise(e=>setTimeout(e,800)),s({totalDevices:150,compliant:128,pending:22,lastUpdate:new Date().toISOString()}),r([{id:1,title:"High CPU Usage on SQL Server",description:"SQL Server on PROD-DB-01 showing 95% CPU utilization",severity:"critical",timestamp:new Date(Date.now()-9e5).toISOString()},{id:2,title:"Failed Windows Update",description:"KB5034441 failed to install on multiple workstations",severity:"high",timestamp:new Date(Date.now()-72e5).toISOString()},{id:3,title:"Low Disk Space Warning",description:"C: drive on FILE-SRV-02 has less than 10% free space",severity:"medium",timestamp:new Date(Date.now()-144e5).toISOString()}]),d([{id:1,type:"Patch Deployment",description:"Deployed security updates to 25 workstations",status:"completed",timestamp:new Date(Date.now()-36e5).toISOString(),agent:"AI-Patch-Agent"},{id:2,type:"Alert Correlation",description:"Correlated 5 disk space alerts into single incident",status:"completed",timestamp:new Date(Date.now()-108e5).toISOString(),agent:"AI-Alert-Agent"},{id:3,type:"Risk Assessment",description:"Analyzing impact of pending CVE-2024-1234 patches",status:"pending",timestamp:new Date(Date.now()-18e5).toISOString(),agent:"AI-Risk-Agent"}]),c([{id:"CVE-2024-9123",cvssScore:9.8,severity:"CRITICAL",description:"Critical RCE vulnerability in Apache HTTP Server allows attackers to execute arbitrary code",published:"2024-10-15T00:00:00",affectedSystems:45,patchAvailable:!0},{id:"CVE-2024-8956",cvssScore:9.4,severity:"CRITICAL",description:"Windows Kernel elevation of privilege vulnerability",published:"2024-10-12T00:00:00",affectedSystems:89,patchAvailable:!0},{id:"CVE-2024-8743",cvssScore:9.1,severity:"CRITICAL",description:"SQL Server remote code execution vulnerability allows unauthenticated attackers",published:"2024-10-10T00:00:00",affectedSystems:23,patchAvailable:!0},{id:"CVE-2024-8521",cvssScore:8.8,severity:"HIGH",description:"OpenSSL buffer overflow vulnerability in TLS handshake processing",published:"2024-10-08T00:00:00",affectedSystems:156,patchAvailable:!0},{id:"CVE-2024-8234",cvssScore:8.6,severity:"HIGH",description:"Chrome V8 type confusion vulnerability allows remote code execution",published:"2024-10-05T00:00:00",affectedSystems:67,patchAvailable:!0},{id:"CVE-2024-7912",cvssScore:8.4,severity:"HIGH",description:"VMware ESXi heap overflow vulnerability in USB service",published:"2024-10-03T00:00:00",affectedSystems:12,patchAvailable:!1},{id:"CVE-2024-7654",cvssScore:8.1,severity:"HIGH",description:"Linux Kernel use-after-free vulnerability in netfilter subsystem",published:"2024-10-01T00:00:00",affectedSystems:34,patchAvailable:!0},{id:"CVE-2024-7432",cvssScore:7.8,severity:"HIGH",description:"Microsoft Exchange Server privilege escalation vulnerability",published:"2024-09-28T00:00:00",affectedSystems:28,patchAvailable:!0},{id:"CVE-2024-7123",cvssScore:7.5,severity:"HIGH",description:"Jenkins arbitrary file read vulnerability through crafted requests",published:"2024-09-25T00:00:00",affectedSystems:8,patchAvailable:!0},{id:"CVE-2024-6890",cvssScore:7.2,severity:"HIGH",description:"Docker Engine privilege escalation through container escape",published:"2024-09-22T00:00:00",affectedSystems:19,patchAvailable:!0}]),h({vulnerabilities:{critical:12,high:28,medium:45,low:18,total:103},patches:{deployed:128,pending:22,failed:5},devices:{total:150,online:145,offline:5,critical:2},automation:{tasksCompleted:687,tasksRunning:8,successRate:97.2}})}catch(e){console.error("Error loading dashboard:",e)}finally{g(!1)}},f=e=>({CRITICAL:"from-red-600 to-red-700",HIGH:"from-orange-500 to-orange-600",MEDIUM:"from-yellow-500 to-yellow-600",LOW:"from-green-500 to-green-600",critical:"from-red-600 to-red-700",high:"from-orange-500 to-orange-600",medium:"from-yellow-500 to-yellow-600",low:"from-green-500 to-green-600"})[e]||"from-gray-500 to-gray-600",N=e=>({CRITICAL:"bg-red-100 text-red-800 border-red-300",HIGH:"bg-orange-100 text-orange-800 border-orange-300",MEDIUM:"bg-yellow-100 text-yellow-800 border-yellow-300",LOW:"bg-green-100 text-green-800 border-green-300",critical:"bg-red-100 text-red-800 border-red-300",high:"bg-orange-100 text-orange-800 border-orange-300",medium:"bg-yellow-100 text-yellow-800 border-yellow-300",low:"bg-green-100 text-green-800 border-green-300"})[e]||"bg-gray-100 text-gray-800 border-gray-300",w=e=>{let s=Math.floor((new Date-new Date(e))/1e3);return s<60?"".concat(s,"s ago"):s<3600?"".concat(Math.floor(s/60),"m ago"):s<86400?"".concat(Math.floor(s/3600),"h ago"):"".concat(Math.floor(s/86400),"d ago")};return u?(0,a.jsx)("div",{className:"flex items-center justify-center min-h-screen bg-gradient-to-br from-slate-50 to-blue-50",children:(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsx)("div",{"data-testid":"loading-spinner",className:"animate-spin rounded-full h-16 w-16 border-t-4 border-b-4 border-blue-600 mx-auto mb-4"}),(0,a.jsx)("p",{className:"text-gray-600 font-medium",children:"Loading AutoOps AI Dashboard..."})]})}):(0,a.jsxs)("div",{className:"min-h-screen bg-gradient-to-br from-slate-50 via-blue-50 to-indigo-50",children:[(0,a.jsx)("div",{className:"bg-white border-b border-gray-200 shadow-sm sticky top-0 z-10",children:(0,a.jsxs)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:[(0,a.jsxs)("div",{className:"flex justify-between items-center py-4",children:[(0,a.jsx)("div",{className:"flex items-center space-x-4",children:(0,a.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,a.jsx)("div",{className:"w-10 h-10 bg-gradient-to-br from-blue-600 to-indigo-600 rounded-xl flex items-center justify-center shadow-lg",children:(0,a.jsx)("span",{className:"text-white font-bold text-xl",children:"\uD83E\uDD16"})}),(0,a.jsxs)("div",{children:[(0,a.jsx)("h1",{className:"text-2xl font-bold text-gray-900",children:"AutoOps AI Dashboard"}),(0,a.jsx)("p",{className:"text-sm text-gray-500",children:"Powered by NVD & SuperOps.ai"})]})]})}),(0,a.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,a.jsxs)("div",{className:"flex items-center space-x-2 px-3 py-1 rounded-lg ".concat(v?"bg-blue-100":"bg-green-100"),children:[(0,a.jsx)("div",{className:"w-2 h-2 rounded-full ".concat(v?"bg-blue-600 animate-pulse":"bg-green-600")}),(0,a.jsx)("span",{className:"text-xs font-medium text-gray-700",children:v?"Refreshing...":"Live"})]}),(0,a.jsx)("button",{onClick:j,className:"px-4 py-2 bg-blue-600 hover:bg-blue-700 text-white rounded-lg font-medium shadow-sm transition-all duration-200 hover:shadow-md",children:"\uD83D\uDD04 Refresh"})]})]}),(0,a.jsx)("div",{className:"flex space-x-1 border-b border-gray-200",children:["overview","vulnerabilities","inventory","alerts","patches"].map(e=>(0,a.jsx)("button",{onClick:()=>b(e),className:"px-6 py-3 font-medium capitalize transition-all duration-200 border-b-2 ".concat(p===e?"border-blue-600 text-blue-600":"border-transparent text-gray-600 hover:text-gray-900 hover:border-gray-300"),children:e},e))})]})}),(0,a.jsxs)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:["overview"===p&&o&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-8",children:[(0,a.jsx)(T,{title:"Total Devices",value:e.totalDevices||0,icon:"\uD83D\uDCBB",gradient:"from-blue-500 to-cyan-500",subtitle:"".concat(o.devices.online," online")}),(0,a.jsx)(T,{title:"Compliant",value:e.compliant||0,icon:"✅",gradient:"from-green-500 to-emerald-500",subtitle:"".concat(Math.round(e.compliant/e.totalDevices*100),"% compliance")}),(0,a.jsx)(T,{title:"Pending Patches",value:e.pending||0,icon:"⏳",gradient:"from-yellow-500 to-orange-500",subtitle:"".concat(o.patches.failed," failed")}),(0,a.jsx)(T,{title:"Critical CVEs",value:n.filter(e=>"CRITICAL"===e.severity).length,icon:"\uD83D\uDEA8",gradient:"from-red-500 to-pink-500",subtitle:"".concat(n.length," total vulnerabilities")})]}),(0,a.jsxs)("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-6 mb-8",children:[(0,a.jsx)("h2",{className:"text-lg font-semibold text-gray-900 mb-4",children:"System Health"}),(0,a.jsxs)("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-6",children:[(0,a.jsx)(M,{label:"Automation Success",value:"".concat(o.automation.successRate,"%"),trend:"up"}),(0,a.jsx)(M,{label:"Tasks Completed",value:o.automation.tasksCompleted,trend:"up"}),(0,a.jsx)(M,{label:"Active Tasks",value:o.automation.tasksRunning,trend:"stable"}),(0,a.jsx)(M,{label:"Critical Devices",value:o.devices.critical,trend:"down"})]})]}),(0,a.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[(0,a.jsx)("div",{className:"lg:col-span-2",children:(0,a.jsx)(O,{cves:n.slice(0,5),getSeverityColor:f,getSeverityBadge:N,formatTimeAgo:w})}),(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsx)(H,{alerts:t,getSeverityBadge:N,formatTimeAgo:w}),(0,a.jsx)(z,{actions:i,formatTimeAgo:w})]})]})]}),"vulnerabilities"===p&&(0,a.jsx)("div",{children:(0,a.jsx)(O,{cves:n,getSeverityColor:f,getSeverityBadge:N,formatTimeAgo:w,full:!0})}),"inventory"===p&&(0,a.jsx)(x,{}),"patches"===p&&(0,a.jsx)(P,{}),"alerts"===p&&(0,a.jsx)(m,{})]})]})}}},function(e){e.O(0,[971,117,744],function(){return e(e.s=5920)}),_N_E=e.O()}]);